[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Analytics Notes",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\n\n\n\n\nCausal Inference (2): Propensity Score Matching\n\n\n\nstatistics\n\n\ncausal-inference\n\n\nR\n\n\n\nATE와 ATT의 차이, 그리고 Love Plot 해석하기\n\n\n\nJan 2, 2026\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCausal Inference (1): RCT vs RWD\n\n\n\nstatistics\n\n\n\n의학 연구에서의 인과추론: 기본 개념\n\n\n\nJun 27, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCompeting Risk Analysis\n\n\n\nstatistics\n\n\n\nCompeting Risk Analysis의 원리와 결과가 가지는 의미를 살펴봅니다\n\n\n\nJan 3, 2025\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2025-01-03-comeptingrisk/index.html",
    "href": "posts/2025-01-03-comeptingrisk/index.html",
    "title": "Competing Risk Analysis",
    "section": "",
    "text": "경쟁 위험(Competing risk)은 한 종류의 이벤트가 발생하면 다른 이벤트가 발생할 수 없는 상황으로 정의됩니다. 예를 들어, 암 재발이 event of interest 인 경우 사망이 competing risk로 작용할 수 있습니다 (사망한 암 환자에게는 암 재발이라는 event가 발생 할 수 없기 때문). 경쟁 위험을 무시하면 모집단의 생존 함수나 이벤트 발생률을 과대 혹은 과소평가 할 위험이 생기기에 이를 고려한 분석이 필요한 경우들이 있습니다. 여러 상황들을 살펴보고, 어떤 지표들을 이용했을 때 어떤 해석이 가능한지 알아보도록 하겠습니다.\n\n\\[\nS(t) = \\prod_{i: t_i \\leq t} \\left(1 - \\frac{d_i}{n_i}\\right)\n\\]\n\nS(t): 생존 함수\n\\(t_i\\): 사건 발생 시점\n\\(d_i\\): 시점 \\(t_i\\)에서 발생한 사건 수\n\\(n_i\\): 시점 \\(t_i\\)에서 위험에 노출된 대상 수\n결국 생존 함수란 각 사건 발생 시점에서의 생존 확률(어떤 이벤트도 발생하지 않을 확률)을 누적 곱하여 계산한 시간 \\(t\\)까지 생존할 확률을 뜻합니다.\n\n\\[\nh_k(t) = \\lim_{\\Delta t \\to 0} \\frac{P(t \\leq T &lt; t + \\Delta t, \\epsilon = k \\mid T \\geq t)}{\\Delta t}\n\\]\n\n\\(\\lambda_k(t)\\): 이벤트 유형 \\(k\\)의 원인별 위험 함수\nT: 이벤트 발생 시간\n\\(\\epsilon\\): 이벤트 유형 지표(Ex. \\(\\epsilon\\) = 1: event of interest, \\(\\epsilon\\) = 2: competing risk )\n결국 위험 함수란 각 시점에서 event k 가 발생할 확률을 뜻합니다.\n\n\\[\nCIF_k(t) = \\int_{0}^{t} h_k(u) S(u) \\, du\n\\]\n이벤트 k에 대한 누적발생률 함수란 결국 시점 마다 생존해 있을 확률 \\(S(t)\\) 와 그 시점 에서 k가 발생할 위험 \\(h_k(t)\\)를 곱하여 합산한 값으로, 시점 t에 이번트 k의 누적 발생률을 뜻하게 됩니다.\n\n경쟁 위험이 없는 생존 분석에서는 대게 Kaplan-Meier 추정치를 사용하지만, 이는 앞서 말했던 예시와 같이 이벤트 발생률을 과대 혹은 과소 평가할 위험이 있기 때문에 경쟁 위험이 있는 경우 적합하지 않은 경우가 많습니다. 암 재발과 사망의 예시를 생각해보겠습니다. Kaplan-Meier 추정치의 경우 사망한 환자의 경우 censoring 된 것으로 처리가 되어 “이 환자의 경우 이후 정보는 알 수 없다”고 간주를 하고 계산하는 추정치입니다. 하지만, 현실에서는 사망한 환자의 경우 이후 암 재발이 일어날 가능성이 0이라는 것을 알 수 있습니다. 반면 CIF의 경우 수식에서도 볼 수 있듯이 사망이 발생해버린 사람은 이미 사건이 발생한 상태로 처리가 되며, 경쟁 이벤트가 발생했다는 \\(CIF_2(t)\\)라는 누적발생률 함수에 따로 기록되고 있는 것을 알 수 있습니다."
  },
  {
    "objectID": "posts/2025-01-03-comeptingrisk/index.html#생존-함수",
    "href": "posts/2025-01-03-comeptingrisk/index.html#생존-함수",
    "title": "Competing Risk Analysis",
    "section": "",
    "text": "\\[\nS(t) = \\prod_{i: t_i \\leq t} \\left(1 - \\frac{d_i}{n_i}\\right)\n\\]\n\nS(t): 생존 함수\n\\(t_i\\): 사건 발생 시점\n\\(d_i\\): 시점 \\(t_i\\)에서 발생한 사건 수\n\\(n_i\\): 시점 \\(t_i\\)에서 위험에 노출된 대상 수\n결국 생존 함수란 각 사건 발생 시점에서의 생존 확률(어떤 이벤트도 발생하지 않을 확률)을 누적 곱하여 계산한 시간 \\(t\\)까지 생존할 확률을 뜻합니다."
  },
  {
    "objectID": "posts/2025-01-03-comeptingrisk/index.html#위험-함수",
    "href": "posts/2025-01-03-comeptingrisk/index.html#위험-함수",
    "title": "Competing Risk Analysis",
    "section": "",
    "text": "\\[\nh_k(t) = \\lim_{\\Delta t \\to 0} \\frac{P(t \\leq T &lt; t + \\Delta t, \\epsilon = k \\mid T \\geq t)}{\\Delta t}\n\\]\n\n\\(\\lambda_k(t)\\): 이벤트 유형 \\(k\\)의 원인별 위험 함수\nT: 이벤트 발생 시간\n\\(\\epsilon\\): 이벤트 유형 지표(Ex. \\(\\epsilon\\) = 1: event of interest, \\(\\epsilon\\) = 2: competing risk )\n결국 위험 함수란 각 시점에서 event k 가 발생할 확률을 뜻합니다."
  },
  {
    "objectID": "posts/2025-01-03-comeptingrisk/index.html#누적발생률-함수cif",
    "href": "posts/2025-01-03-comeptingrisk/index.html#누적발생률-함수cif",
    "title": "Competing Risk Analysis",
    "section": "",
    "text": "\\[\nCIF_k(t) = \\int_{0}^{t} h_k(u) S(u) \\, du\n\\]\n이벤트 k에 대한 누적발생률 함수란 결국 시점 마다 생존해 있을 확률 \\(S(t)\\) 와 그 시점 에서 k가 발생할 위험 \\(h_k(t)\\)를 곱하여 합산한 값으로, 시점 t에 이번트 k의 누적 발생률을 뜻하게 됩니다."
  },
  {
    "objectID": "posts/2025-01-03-comeptingrisk/index.html#왜-경쟁-위험-분석에서-cif를-사용할까",
    "href": "posts/2025-01-03-comeptingrisk/index.html#왜-경쟁-위험-분석에서-cif를-사용할까",
    "title": "Competing Risk Analysis",
    "section": "",
    "text": "경쟁 위험이 없는 생존 분석에서는 대게 Kaplan-Meier 추정치를 사용하지만, 이는 앞서 말했던 예시와 같이 이벤트 발생률을 과대 혹은 과소 평가할 위험이 있기 때문에 경쟁 위험이 있는 경우 적합하지 않은 경우가 많습니다. 암 재발과 사망의 예시를 생각해보겠습니다. Kaplan-Meier 추정치의 경우 사망한 환자의 경우 censoring 된 것으로 처리가 되어 “이 환자의 경우 이후 정보는 알 수 없다”고 간주를 하고 계산하는 추정치입니다. 하지만, 현실에서는 사망한 환자의 경우 이후 암 재발이 일어날 가능성이 0이라는 것을 알 수 있습니다. 반면 CIF의 경우 수식에서도 볼 수 있듯이 사망이 발생해버린 사람은 이미 사건이 발생한 상태로 처리가 되며, 경쟁 이벤트가 발생했다는 \\(CIF_2(t)\\)라는 누적발생률 함수에 따로 기록되고 있는 것을 알 수 있습니다."
  },
  {
    "objectID": "posts/2025-01-03-comeptingrisk/index.html#fine-gray-method",
    "href": "posts/2025-01-03-comeptingrisk/index.html#fine-gray-method",
    "title": "Competing Risk Analysis",
    "section": "Fine-Gray Method",
    "text": "Fine-Gray Method\n경쟁위험이 존재하는 경우 생존 함수인 \\(S(t)\\)가 \\(1-CIF(t)\\)로 치환되지 않기 때문에 전통적 위험함수로는 \\(CIF(t)\\)를 추정할 수 없다는 한계가 있습니다. (\\(S(t)+CIF_1(t)+CIF_2(t)+....+CIF_k(t)=1\\)이기 때문) 따라서, Fine-Gray Method 에서는 \\(1-CIF(t)\\)의 시간에 따른 변화량을 추적하는 함수인 Subdistribution hazard function을 새로 추정합니다.\n하위 분포 위험의 경우 아래의 식과 같이 계산할 수 있습니다. \\[\nh_k^{sd}(t)\n\\;=\\;\n-\\,\\frac{d}{dt} \\,\\ln\\!\\bigl\\{1 - CIF_k(t)\\bigr\\}\n\\;=\\;\n\\frac{h_k^{cs}(t) S(t)}{\\,1 - CIF_k(t)\\,}.\n\\] 하위 분포 위험의 경우 \\(h_k^{sd}(t)\\)로 표기를 하고 이는 \\(CIF_k(t)\\)의 변화량을 추정할 수 있는 위험 함수입니다. 또한 여기서 \\(h_k^{cs}(t)\\)의 경우 cause-specific hazard function으로, 앞서 정의한 위험함수와 같은 의미를 가집니다.(subdistrivution hazard function과 구분하기 위해 이렇게 지칭하도록 하겠습니다). 그렇다면 \\(h_k^{sd}(t)\\)는 어떻게 해석을 할 수 있을지 알아보겠습니다. 우선 \\(S(t)\\)가 \\(1-CIF(t)\\)로 치환이 되는 경쟁위험이 없는 상황에서는 cause-specific hazard function과 완전히 동일하다는 것을 알 수 있습니다. 하지만 그렇지 않은 경우 cause-specific hazard function에 \\(\\frac {S(t)}{\\,1 - CIF_k(t)\\,}\\)을 곱한 값이 된다는 것을 알 수 있고, 이는 관심 event가 발생하지 않은 모든 사람이 분모 즉, risk set에 포함된다는 것을 알 수 있습니다. 이는 곧 아래의 수식으로 표현될 수 있습니다.\n\\[\nh_k^{sd}(t) = \\lim_{\\Delta t \\to 0} \\frac{P(t \\leq T &lt; t+\\Delta t, \\text{Cause} = k \\mid T \\geq t \\cup \\text{(Cause } \\neq k \\text{ 발생)})}{\\Delta t}\n\\] 예를 들어, event of interest가 암의 재발이고 comepting risk가 사망인 경우 전통적 생존 분석에서는 시간 t에서 살아 있는 환자들이 risk set이 된다면 subdistribution hazard function 에서는 시간 t에서 살아있는 사람들과 시간 t전에 competing risk를 경험한(사망한)사람들 또한 risk set에 포함된다는 차이가 있습니다. Fine-Gray Method에서는 이 subdistribution hazard function을 이용하여 \\(\\beta\\)값을 추정하여 \\(CIF(t)\\)에 대한 보다 직접적인 추정을 가능하게 하는 방법입니다. Fine-Gray Method 분석법을 실행하는 방법과 전통적 생존 분석과 어떻게 비교하여 어떻게 수치들을 해석할 수 있는지를 알아보겠습니다."
  },
  {
    "objectID": "posts/2025-01-03-comeptingrisk/index.html#fine-gray-method-와-전통적-생존함수-비교",
    "href": "posts/2025-01-03-comeptingrisk/index.html#fine-gray-method-와-전통적-생존함수-비교",
    "title": "Competing Risk Analysis",
    "section": "Fine-Gray Method 와 전통적 생존함수 비교",
    "text": "Fine-Gray Method 와 전통적 생존함수 비교\n다음과 같은 상황을 한번 생각해보겠습니다. 심부전 환자에서 중증 우울증 진단 여부에 따른 심장질환 관련 사망여부가 달라지는지 관심이 있는 상황을 가정해보겠습니다. 이 경우 CVD death가 Event of Interest가 되고 non-CVD death가 Competing risk가 될 것입니다. (non-CVD death로 사망하는 경우 심장 질환 관련 사망으로 사망하는지 관찰할 수 없기 때문). 우울증 진단 여부가 심장 질환 관련 사망에 관련이 없지만, 자살율을 크게 증가시켜 non-CVD death를 많이 발생시킨다고 한번 가정해보도록 하겠습니다. 가정에 따라 데이터를 한번 만들어보겠습니다.\n\nN &lt;- 10000\n# 우울증 여부를 배정\nDepression_status &lt;- c(rep(0, N/2), rep(1, N/2))\n#임의로 성별 배정\nSex &lt;- sample(c(0,1), size = N, replace = TRUE)\n\n# hazard를 가정에 맞게 정의\nlambda_cvd &lt;- 0.2  # CVD death 여부는 우울증과 무관하게 매년 0.2\nlambda_non_cvd_no_depression &lt;- 0.1  # Non-CVD death의 경우 비우울증 인구에서는 0.1\nlambda_non_cvd_depression &lt;- 0.5      # Non-CVD death rate가 자살율의 증가로 인해 우울증 인구에서 0.5\n\nCVD_time &lt;- numeric(N)\nnon_CVD_time &lt;- numeric(N)\nTime &lt;- numeric(N)\nEvent &lt;- numeric(N)\n\n# Simulate times\nfor (i in 1:N) {\n\n  CVD_time[i] &lt;- rexp(1, rate = lambda_cvd)\n  \n  if (Depression_status[i] == 0) {\n    non_CVD_time[i] &lt;- rexp(1, rate = lambda_non_cvd_no_depression)\n  } else {\n    non_CVD_time[i] &lt;- rexp(1, rate = lambda_non_cvd_depression)\n  }\n  if (CVD_time[i] &lt; non_CVD_time[i]) {\n    Time[i] &lt;- CVD_time[i]\n    Event[i] &lt;- 1  \n  } else {\n    Time[i] &lt;- non_CVD_time[i]\n    Event[i] &lt;- 2  \n  }\n}\n\nsample_data &lt;- data.frame(\n  ID = 1:N,\n  Time = round(Time, 2),\n  Event = Event,\n  Sex = ifelse(Sex == 1, \"Male\", \"Female\"),\n  Depression = ifelse(Depression_status == 1, \"Yes\", \"No\"),\n  CVD_time = round(CVD_time, 2)  \n)\n\nhead(sample_data, n= 15)\n\n   ID  Time Event    Sex Depression CVD_time\n1   1  0.79     1 Female         No     0.79\n2   2  1.86     1   Male         No     1.86\n3   3  3.15     1 Female         No     3.15\n4   4  1.63     1 Female         No     1.63\n5   5 12.37     1   Male         No    12.37\n6   6  3.34     1   Male         No     3.34\n7   7  3.16     1 Female         No     3.16\n8   8  3.12     1   Male         No     3.12\n9   9 11.77     2 Female         No    18.13\n10 10  2.08     2 Female         No     3.82\n11 11  4.97     1   Male         No     4.97\n12 12  1.47     1 Female         No     1.47\n13 13  0.85     1 Female         No     0.85\n14 14  7.53     2   Male         No    10.97\n15 15  0.43     2   Male         No     2.68\n\n\n데이터에서 Time은 Death(CVD, non-CVD 포함)가 발생한 시점입니다. R의 cmprsk 패키지를 통해 fine gray method로 분석을 진행하고, 전통적 생존 분석또한 함께 진행해보겠습니다.\n\nlibrary(dplyr);library(survival);library(jstable)\nsample_data &lt;- sample_data %&gt;%\n  mutate(\n    Sex_num = ifelse(Sex == \"Male\", 1, 0),\n    Depression_num = ifelse(Depression == \"Yes\", 1, 0)\n  ) \nsurv_object_csh &lt;- Surv(time = sample_data$Time, event = sample_data$Event == 1)\ncox_csh &lt;- coxph(surv_object_csh ~ Depression_num, data = sample_data, model = T)\ncox2.display(cox_csh)\n\n$table\n               HR(95%CI)          P value\nDepression_num \"1.01 (0.94,1.07)\" \"0.863\"\n\n$metric\n                    [,1]               [,2]\n&lt;NA&gt;                NA                 NA  \nNo. of observations \"10000\"            NA  \nNo. of events       \"4768\"             NA  \nAIC                 \"77088.5386368581\" NA  \nC-Index             \"0.503(0.004)\"     NA  \n\n$caption\n[1] \"Cox model on time ('NA, surv_object_csh, character(0)') to event ('surv_object_csh')\"\n\n\nexp(coef= beta)즉 Hazard ratio가 1이고 p-value가 0.936으로, 우울증 여부가 CVD-death에 영향을 미치지 않는 다는 것을 알 수 있습니다. 이는 데이터를 만들때의 가정과 동일하기 때문에 전통적 생존분석은 이를 잘 반영한다는 것을 알 수 있습니다. 이번엔 competing risk를 고려한 fine gray method로 분석을 해보겠습니다.\n\nlibrary(cmprsk)\nftime &lt;- sample_data$Time\nfstatus &lt;- sample_data$Event\ncovariates &lt;- sample_data %&gt;% select(Depression_num)\nfg_model &lt;- crr(ftime = ftime, fstatus = fstatus, cov1 = covariates)\nsummary(fg_model)\n\nCompeting Risks Regression\n\nCall:\ncrr(ftime = ftime, fstatus = fstatus, cov1 = covariates)\n\n                 coef exp(coef) se(coef)     z p-value\nDepression_num -0.995      0.37    0.033 -30.1       0\n\n               exp(coef) exp(-coef)  2.5% 97.5%\nDepression_num      0.37        2.7 0.347 0.395\n\nNum. cases = 10000\nPseudo Log-likelihood = -41995 \nPseudo likelihood ratio test = 1088  on 1 df,\n\n\nexp(coef) 즉 subdistribution hazard ratio가 0.363이고, p value 가 &lt;0.01임으로 우울증이 있는 사람에게는 CVD-death가 덜 발생한다고 해석할 수 있습니다. 우울증 여부가 CVD-death에 영향을 미치지 않게 데이터를 만들었는데 왜 이런 결과가 나왔는지 그리고 서로 다르게 나온 두 결과를 각각 어떻게 해석해야 되는지를 알아보겠습니다. 우울증 환자와 비 우울증 환자에서 CVD-death에 대한 CIF를 한번 그려보도록 하겠습니다.\n\ngroup &lt;- sample_data$Depression_num\ncif_cvd &lt;- cuminc(ftime, fstatus, group = group, cencode = 0)\nplot(1, type = \"n\", xlab = \"Time (years)\", ylab = \"Cumulative Incidence\",\n     xlim = c(0, 15), ylim = c(0, 1),\n     main = \"Cumulative Incidence of CVD Death by Depression Status\")\nlines(cif_cvd[[1]]$time, cif_cvd[[1]]$est, col = \"blue\", lty = 1, lwd = 2)\nlines(cif_cvd[[2]]$time, cif_cvd[[2]]$est, col = \"purple\", lty = 1, lwd = 2)\n\nlegend(\"topright\", \n       legend = c(\"Non-Depression - CVD Death\", \"Depression - CVD Death\"),\n       col = c(\"blue\", \"purple\"),\n       lty = 1,\n       lwd = 2)\n\n\n\n\n\n\n\n우울증 여부가 CVD-death에 영향을 미치지 않는다 하더라고, 우울증 환자에게서 CVD-death가 덜 발생한다는 것을 관찰할 수 있습니다. 이는 우울증 환자에서 이미 non-CVD death를 경험하여 CVD-death를 경험할 수 없기 때문이라는 것을 CVD, non-CVD death에 대한 CIF로 알아볼 수 있습니다.\n\nplot(1, type = \"n\", xlab = \"Time (years)\", ylab = \"Cumulative Incidence\",\n     xlim = c(0, 15), ylim = c(0, 1),\n     main = \"Cumulative Incidence of CVD Death by Depression Status\")\nlines(cif_cvd[[1]]$time, cif_cvd[[1]]$est, col = \"blue\", lty = 1, lwd = 2)\nlines(cif_cvd[[2]]$time, cif_cvd[[2]]$est, col = \"red\", lty = 1, lwd = 2)\nlines(cif_cvd[[3]]$time, cif_cvd[[3]]$est, col = \"skyblue\", lty = 1, lwd = 2)\nlines(cif_cvd[[4]]$time, cif_cvd[[4]]$est, col = \"pink\", lty = 1, lwd = 2)\n\n\nlegend(\"topright\", \n       legend = c(\"Non-Depression - CVD Death\", \"Depression - CVD Death\", \n                  \"Non-Depression - Non-CVD Death\", \"Depression - Non-CVD Death\"),\n       col = c(\"blue\", \"red\", \"skyblue\", \"pink\"),\n       lty = 1, lwd = 2, bty = \"n\", cex = 0.8)\n\n\n\n\n\n\n\n실제로 Depression 군에서는 non-CVD death가 급격하게 많이 발생하여, CVD-death의 CIF가 낮게 나오고 있다는 것을 확인 할 수 있습니다. non-CVD death가 발생하지 않은 경우를 가정하여 만들어 놓은 CVD_time변수로 Depression군과 non-Depression 군의 CIF를 비교해보도록 하겠습니다.\n\nlibrary(cmprsk)\nftime &lt;- sample_data$CVD_time\nfstatus &lt;- 1\ngroup &lt;- sample_data$Depression_num\ncif_cvd &lt;- cuminc(ftime, fstatus, group = group, cencode = 0)\nplot(1, type = \"n\", xlab = \"Time (years)\", ylab = \"Cumulative Incidence\",\n     xlim = c(0, 15), ylim = c(0, 1),\n     main = \"Cumulative Incidence of CVD Death by Depression Status\")\nlines(cif_cvd[[1]]$time, cif_cvd[[1]]$est, col = \"blue\", lty = 1, lwd = 2)\nlines(cif_cvd[[2]]$time, cif_cvd[[2]]$est, col = \"purple\", lty = 1, lwd = 2)\n\nlegend(\"topright\", \n       legend = c(\"Non-Depression - CVD Death\", \"Depression - CVD Death\"),\n       col = c(\"blue\", \"purple\"),\n       lty = 1, lwd = 2, bty = \"n\", cex = 0.8)\n\n\n\n\n\n\n\n두개의 그래프가 거의 일치하는 것을 확인할 수 있습니다. 즉 Competing risk의 존재는, 실제로 우울증이 CVD death에 영향을 미치지 않더라고, CIF에는 변화를 줄 수 있다는 것을 확인할 수 있습니다."
  },
  {
    "objectID": "posts/2025-01-03-comeptingrisk/index.html#how-to-interpret",
    "href": "posts/2025-01-03-comeptingrisk/index.html#how-to-interpret",
    "title": "Competing Risk Analysis",
    "section": "How to Interpret",
    "text": "How to Interpret\n지금까지 얻은 정보를 종합하여, cause-specific hazard와 subdistribution hazard 함수가 각각 어떤 질문에 적합한지, 어떤 내용을 설명하는지 정리해보겠습니다. Cause-specific hazard function은 “A라는 변수가 실제로 B에 영향을 미치는가?”와 같은 원인적(etiologic) 질문에 더 적합한 함수입니다. 예를 들어, “우울증이 CVD 사망을 유발하는가?”라는 질문에 답하기 위해서는 cause-specific hazard function을 사용하는 것이 더 적절할 수 있습니다. 반면, subdistribution hazard ratio는 “우울증이 CVD 사망의 발생률에 어떤 영향을 미치는가?”와 같은 예후(prognostic) 질문에 더 적합한 함수입니다. 이는 subdistribution hazard ratio가 Cumulative Incidence Function (CIF)을 직접적으로 추정하기 때문에, CIF 함수와 긴밀하게 연관되어 있습니다. 따라서 예후를 예측하는 측면에서는 Fine-Gray 방법을 이용한 분석이, 원인을 분석하는 측면에서는 전통적인 생존 분석이 더 적절합니다. 두 분석 결과를 함께 고려함으로써, 경쟁 위험이 존재하는 상황에서 관심 있는 사건에 영향을 미치는 요인들에 대한 포괄적인 분석을 수행할 수 있습니다.\nPS. Censoring이 존재하는 경우\nSubdistribution hazard function을 살펴볼 때, censoring이 존재하지 않고 환자를 이벤트가 발생할 때까지 관찰할 수 있다는 가정(complete data로 통칭)하에 risk set이 정의가 되었습니다. Censoring이 존재하는 경우 risk set이 어떻게 존재하는지 알아보겠습니다. Complete data의 경우 competing risk가 발생한 환자도, 발생한 시점 외에도 계속 한명의 존재로 risk set에 남아있다는 것을, 앞선 subdistribution hazard function의 유도과정에서 살펴보았습니다. Censoring이 생기는 경우 IPCW(Inverse probability censor weighting)이라는 방법을 통해, censoring이 된 환자의 예후를 반영하는 방법을 fine-gray method에서 사용하고 있습니다. 시점 t에서 100명이 생존한 와중에 60명이 censoring되고 40명에게 event가 발생하거나, 관측되거나 했다고 가정해봅시다. Censoring이라는 과정이 환자의 event 발생여부나 baseline에 관계없이 발생한다는 가정이 있다면 남은 40명에게 각각 2.5배의 가중치를 준다면, censoring이 발생하지 않고 100명을 계속 관측하는 것과 동일한 결과를 얻을 수 있다는 것이 IPCW의 방법론입니다. 따라서 시점 t이전에 competing event가 발생한 사람의 경우 여전히 한명으로 risk set에 기여를 하게 되고, 시점 t에서 censoring된 사람들은 2.5배의 가중치를 받아 risk set과 event set에 반영이 됩니다. 즉 competing risk가 발생한 환자들의 경우 여전히 한명으로 risk set에 기여하지만, 실질적으로 기여하는 가중치는 적어진다는 것을 알 수 있습니다. 이를 반영한 것이 survival package의 finegray함수이며, 이를 이용하여 finegray method를 통한 분석 또한 가능합니다.\n\nlibrary(survival)\ndata &lt;- mgus2\ndata$etime &lt;- with(data, ifelse(pstat==0, futime, ptime))\ndata$event &lt;- with(data, ifelse(pstat==0, 2*death, 1))\ndata$event &lt;- factor(data$event, 0:2, labels=c(\"censor\", \"pcm\", \"death\"))\npdata &lt;- finegray(Surv(etime, event) ~ ., data=data)\nhead(pdata)\n\n  id age sex dxyr  hgb creat mspike ptime pstat futime death fgstart fgstop\n1  1  88   F 1981 13.1   1.3    0.5    30     0     30     1       0     35\n2  1  88   F 1981 13.1   1.3    0.5    30     0     30     1      35     44\n3  1  88   F 1981 13.1   1.3    0.5    30     0     30     1      44     47\n4  1  88   F 1981 13.1   1.3    0.5    30     0     30     1      48     52\n5  1  88   F 1981 13.1   1.3    0.5    30     0     30     1      53     56\n6  1  88   F 1981 13.1   1.3    0.5    30     0     30     1      56     57\n  fgstatus      fgwt\n1        0 1.0000000\n2        0 0.9990449\n3        0 0.9980368\n4        0 0.9959629\n5        0 0.9905896\n6        0 0.9873022\n\n\n데이터에서 볼 수 있듯이 competing risk가 발생한 환자의 경우 추적 종료까지 risk set에 기여도는 낮아지지만, 끝까지 포함되어 있다는 것을 알 수 있습니다. 또한 얻은 pdata로 기존의 생존분석과 같은 함수를 사용하면, 가중치가 반영되어 fine gray method로 구한 subdistribution hazard function에 대한 coefficient값을 얻을 수 있다는 것을 알 수 있습니다.\n\nfgfit &lt;- coxph(Surv(fgstart, fgstop, fgstatus) ~ age+sex,\n               weight=fgwt, data=pdata, model = T)\nsummary(fgfit)\n\nCall:\ncoxph(formula = Surv(fgstart, fgstop, fgstatus) ~ age + sex, \n    data = pdata, weights = fgwt, model = T)\n\n  n= 41775, number of events= 115 \n\n          coef exp(coef)  se(coef) robust se     z Pr(&gt;|z|)   \nage  -0.017302  0.982847  0.007022  0.005528 -3.13  0.00175 **\nsexM -0.259757  0.771239  0.187049  0.181707 -1.43  0.15285   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n     exp(coef) exp(-coef) lower .95 upper .95\nage     0.9828      1.017    0.9723    0.9936\nsexM    0.7712      1.297    0.5402    1.1012\n\nConcordance= 0.548  (se = 0.026 )\nLikelihood ratio test= 7.28  on 2 df,   p=0.03\nWald test            = 11.19  on 2 df,   p=0.004\nScore (logrank) test = 7.58  on 2 df,   p=0.02,   Robust = 9.28  p=0.01\n\n  (Note: the likelihood ratio and score tests assume independence of\n     observations within a cluster, the Wald and robust score tests do not)."
  },
  {
    "objectID": "posts/2025-06-27-causal/index.html",
    "href": "posts/2025-06-27-causal/index.html",
    "title": "Causal Inference (1)",
    "section": "",
    "text": "영화 에브리씽 에브리웨어 올 앳 원스(Everything Everywhere All at Once)에서 평범한 세탁소의 주인인 에블린은 다른 평행 우주의 자신들과 연결될 수 있는 존재임을 깨닫는다. 그녀가 본 그녀의 평행 우주에는 남편을 따라 미국으로 가지 않았다면, 세계적인 영화배우가 된 자신 미슐랭 스타를 받은 요리사가 된 그녀의 삶부터 접시 돌리기를 하며 다른 사람과 결혼한 삶 등이 있다. 그리고 다른 한 편에는 에블린의 딸의 다른 자아인 조부 투파키가 있다. 조부 투파키는 수많은 평행우주의 삶들을 보았고, 다중우주의 가능성과 존재의 의미없음을 깨달아 버린 존재다. 조부 투파키가 가져오는 수많은 허무에 맞서, 에블린은 역설적으로 화려한 다중우주 속에서 초라하고 평범해보이는 자신의 삶의 소중함을 깨닫는다.\n우리는 늘 평행 우주속의 또 다른 나를 상상하며 산다. 다른 나라에서 태어난 나 혹은 다른 전공을 선택한 평행우주의 나를 상상하며 살아가곤 한다. 일어나지 않은 일을 상상할 수 있다는 것은 우리에게 어떤 의미를 가질까."
  },
  {
    "objectID": "posts/2025-06-27-causal/index.html#인과추론의-근본적인-문제-the-fundamental-problem-of-causal-inference",
    "href": "posts/2025-06-27-causal/index.html#인과추론의-근본적인-문제-the-fundamental-problem-of-causal-inference",
    "title": "Causal Inference (1)",
    "section": "1. 인과추론의 근본적인 문제 (The Fundamental Problem of Causal Inference)",
    "text": "1. 인과추론의 근본적인 문제 (The Fundamental Problem of Causal Inference)\n임상 현장에서는 특정 질환에 대해 여러 치료 대안이 존재할 때, 어떤 치료법이 더 나은 예후를 가져오는지 판단해야 하는 문제에 직면한다. 예를 들어, 특정 암으로 진단된 65세 남성 환자 ‘A’씨가 있고, 치료법으로 ’수술’과 ’약물치료’가 고려되고 있다고 가정해 보자. 이 연구에서 관심 있는 최종 결과는 ’1년 후 생존 여부’(생존 시 1, 사망 시 0)이다.\n인과추론의 핵심 개념인 잠재적 결과 프레임워크(Potential Outcomes Framework)는 이 상황을 다음과 같이 설명한다. A씨에게는 우리가 관찰할 수는 없지만 개념적으로 존재하는 두 가지의 잠재적 결과가 있다.\n\n\n\\(Y_{A}(1)\\): A씨가 ’수술’을 받았을 경우의 1년 후 생존 상태\n\n\\(Y_{A}(0)\\): A씨가 ’약물치료’를 받았을 경우의 1년 후 생존 상태\n\n만약 우리가 신처럼 모든 가능성을 알 수 있어, A씨가 수술을 받으면 1년 후 생존하고(\\(Y_{A}(1)=1\\)), 약물치료를 받으면 1년 후 사망한다(\\(Y_{A}(0)=0\\))는 사실을 안다고 상상해 보자. 이때 A씨 개인에 대한 수술의 인과적 효과는 \\(Y_{A}(1) - Y_{A}(0) = 1 - 0 = 1\\)로 명확하게 계산된다. 이 차이값, 즉 한 개인에 대한 잠재적 결과들의 차이가 바로 우리가 궁극적으로 알고자 하는 ‘진정한 인과적 효과(true causal effect)’이다. 이는 해당 치료가 그 개인에게 미친 순수한 영향의 크기를 의미한다.\n그러나 현실 세계에서 A씨는 두 가지 치료 중 단 하나만 받을 수 있다. 만약 그가 실제로 수술을 선택하여 1년 후 생존했다면, 우리는 \\(Y_{A}(1)=1\\)이라는 ‘사실적(factual)’ 결과만을 관찰할 수 있다. 그가 만약 약물치료를 받았더라면 어땠을지에 대한 결과, 즉 \\(Y_{A}(0)\\)의 값은 영원히 관찰 불가능한 ’반사실적 사실(Counterfactual)’로 남게 된다.\n이처럼 동일한 개인에 대해 모든 잠재적 결과를 동시에 관찰하는 것이 원천적으로 불가능하다는 점, 이것이 바로 ‘인과추론의 근본적인 문제(The Fundamental Problem of Causal Inference)’이다."
  },
  {
    "objectID": "posts/2025-06-27-causal/index.html#무작위-배정-임상시험-rct과-교환가능성",
    "href": "posts/2025-06-27-causal/index.html#무작위-배정-임상시험-rct과-교환가능성",
    "title": "Causal Inference (1)",
    "section": "2. 무작위 배정 임상시험 (RCT)과 교환가능성",
    "text": "2. 무작위 배정 임상시험 (RCT)과 교환가능성\n앞에서 살펴본 ‘A씨’ 개인에 대한 수술의 인과적 효과(\\(Y_{A}(1) - Y_{A}(0)\\))를 아는 것은 ‘인과추론의 근본적인 문제’로 인해 불가능하다. 그렇다면 연구자로서 우리는 어떤 의미 있는 질문을 던질 수 있을까? 바로 “A씨 한 명이 아니라, A씨와 유사한 특성을 가진 환자 집단 전체에서 수술은 약물치료에 비해 평균적으로 얼마나 효과적인가?”라는 질문이다. 이처럼 목표를 개인에서 집단으로 수정하여, 특정 인구 집단 전체에 대한 ’평균 인과 효과(Average Causal Effect, ACE 또는 Average Treatment Effect, ATE)를 추정하는 것으로 전환한다.\n이 개념을 이해하기 위해, 해당 질환을 가진 환자가 10명(A부터 J까지)뿐인 가상의 인구 집단을 상상해 보자. 신의 관점에서 이들 각각의 잠재적 결과를 모두 알고 있다고 가정하면 아래 표와 같다. (생존=1, 사망=0)\n\n\n\n\n\n\n\n\n환자\n수술 시 생존 여부 \\(Y(1)\\)\n\n약물치료 시 생존 여부 \\(Y(0)\\)\n\n개인의 인과 효과 \\(Y(1) - Y(0)\\)\n\n\n\n\nA\n1\n0\n1\n\n\nB\n1\n1\n0\n\n\nC\n0\n0\n0\n\n\nD\n1\n0\n1\n\n\nE\n1\n0\n1\n\n\nF\n1\n1\n0\n\n\nG\n0\n1\n-1\n\n\nH\n1\n0\n1\n\n\nI\n0\n0\n0\n\n\nJ\n1\n0\n1\n\n\n\n위 표에서 각 개인에 대한 치료의 인과 효과는 이질적(heterogeneous)이다. A, D, E, H, J 환자에게 수술은 생존을 결정짓는 긍정적 효과(+1)를 가진다. B와 F 환자에게는 두 치료법 모두 효과가 있어 차이가 없고(0), C와 I 환자에게는 두 치료법 모두 효과가 없어 역시 차이가 없다(0). 특히 G 환자의 경우, 오히려 약물치료가 더 나은 결과를 보여 수술의 효과는 부정적(-1)이다. 현실에서는 이 마지막 열, 즉 개인별 효과를 결코 알 수 없다.\n평균 인과 효과(ACE)는 바로 이 마지막 열에 있는 개인별 인과 효과들의 평균이다. \\[\\text{ACE} = \\frac{1+0+0+1+1+0+(-1)+1+0+1}{10} = \\frac{4}{10} = 0.4\\] 이 값 \\(0.4\\)는 이 인구 집단에서 약물치료 대신 수술을 선택할 경우, 생존할 확률이 평균적으로 \\(0.4\\) (또는 \\(40\\%\\)p) 증가함을 의미한다. 이는 G 환자처럼 일부에게는 수술이 해가 되더라도, 집단 전체적으로는 수술이 더 이득이 됨을 보여주는 중요한 정보다.\n이처럼 개인 수준의 효과는 알 수 없지만, 연구자들은 집단 수준의 평균적인 효과를 추정함으로써 치료법의 가치를 평가하고 임상적 의사결정에 대한 과학적 근거를 제공할 수 있다. 앞선 예시에서 우리가 신의 관점으로 계산한 ‘진정한’ 평균 인과 효과(ACE)는 \\(0.4\\)였다. 이제 현실의 연구자가 이 값을 어떻게 추정해 나가는지 살펴본다.\n\n무작위 배정과 평균 인과 효과 추정\n이 평균 인과 효과를 가장 신뢰도 높게 추정하기 위한 연구 설계가 바로 무작위 배정 임상시험(Randomized Controlled Trial, RCT)이다. RCT의 핵심은 무작위 배정(randomization)에 있다. 앞선 10명의 환자(A~J)를 동전 던지기와 같은 확률적 과정에 따라 5명은 수술군(Treatment, \\(T=1\\))에, 나머지 5명은 약물치료군(Control, \\(T=0\\))에 배정한다고 가정해 보자.\n무작위 배정은 매우 강력한 도구로, 각 환자가 어떤 치료를 받을지 오직 우연에 의해서만 결정되도록 한다. 만약 대상자 수가 충분히 많다면, 무작위 배정은 치료군과 대조군이 치료와 무관한 모든 특성(나이, 성별, 기저 질환의 중증도, 생활 습관 등)에서 평균적으로 거의 동일하게 분포되도록 만든다. 이는 마치 두 집단이 ‘복제된(counterfactual) 상태’와 같이 되는 것을 의미한다.\n여기서는 10명이라는 소규모 집단이지만, 무작위 배정이 성공적으로 이루어져 두 그룹의 기저 특성이 잘 균형을 이루었다고 가정해 보자. 예를 들어, 한 가지 무작위 배정 결과가 아래와 같이 나왔다고 하자.\n\n\n수술군 (\\(T=1\\)): {A, D, E, H, J}\n\n약물치료군 (\\(T=0\\)): {B, C, F, G, I}\n\n연구자는 이제 신의 관점이 아닌, 실제 관찰된 데이터만을 볼 수 있다. 즉, 수술군에 속한 환자에게서는 수술 후의 결과(\\(Y(1)\\))만을, 약물치료군에 속한 환자에게서는 약물치료 후의 결과(\\(Y(0)\\))만을 관찰하게 된다.\n\n\n환자\n배정된 군 (T)\n실제 관찰된 결과 (Y)\n\n\n\nA\n1 (수술)\n\\(Y_{A}(1)=1\\)\n\n\nB\n0 (약물)\n\\(Y_{B}(0)=1\\)\n\n\nC\n0 (약물)\n\\(Y_{C}(0)=0\\)\n\n\nD\n1 (수술)\n\\(Y_{D}(1)=1\\)\n\n\nE\n1 (수술)\n\\(Y_{E}(1)=1\\)\n\n\nF\n0 (약물)\n\\(Y_{F}(0)=1\\)\n\n\nG\n0 (약물)\n\\(Y_{G}(0)=1\\)\n\n\nH\n1 (수술)\n\\(Y_{H}(1)=1\\)\n\n\nI\n0 (약물)\n\\(Y_{I}(0)=0\\)\n\n\nJ\n1 (수술)\n\\(Y_{J}(1)=1\\)\n\n\n\n이 관찰된 데이터를 바탕으로 연구자는 각 그룹의 평균 결과를 계산한다.\n\n관찰된 수술군의 평균 생존율: \\(E[Y|T=1] = (1+1+1+1+1)/5 = 1.0\\)\n\n관찰된 약물치료군의 평균 생존율: \\(E[Y|T=0] = (1+0+1+1+0)/5 = 0.6\\)\n\n관찰된 결과의 차이: \\(1.0 - 0.6 = 0.4\\)\n\n\n이 값(\\(0.4\\))은 우리가 앞에서 신의 관점으로 계산했던 실제 ACE(\\(0.4\\))와 정확히 일치한다. 10명이라는 작은 표본에서도 무작위 배정이 성공적으로 이루어진다면 이렇게 실제 평균 인과 효과를 잘 추정할 수 있다. 물론 실제 임상 연구에서는 무작위 오차(Random Error)를 줄이기 위해 훨씬 더 많은 수의 환자를 대상으로 연구를 수행하며, 이러한 과정을 통해 관찰된 차이는 ‘진정한’ 평균 인과 효과에 더욱 가깝게 수렴하게 된다.\n교환가능성 (Exchangeability): RCT의 핵심 가정\n이것이 가능한 근본적인 원리가 바로 교환가능성(Exchangeability)이다. 무작위 배정은 두 집단의 모든 특성을 평균적으로 동일하게 만들어, 치료 개입이 시작되기 전 시점에서 두 집단을 통계적으로 거의 복제된 상태로 만든다. ’교환가능성’은 기호를 통해 더 깊이 이해할 수 있다. 무작위 배정 덕분에 우리는 치료군과 대조군의 잠재적 결과가 다음과 같은 관계를 가진다고 가정할 수 있다.\n우리가 앞서 본 10명의 환자 예시를 다시 떠올려 보자. 이 환자들을 두 그룹으로 나눌 때, 난수표를 이용해 짝수 번호가 나온 환자는 수술군에, 홀수 번호가 나온 환자는 약물치료군에 배정하는 것과 같다. 이렇게 무작위로 배정하면, 마치 신의 관점에서 보았을 때 두 그룹이 완벽하게 균형을 이루게 된다.\n예를 들어, 난수표를 통해 짝수 번호를 받아 수술군에 배정된 환자 5명(A, D, E, H, J)이 실제로 수술을 받았을 때 5명 모두 생존하여 생존율이 100%(\\(1.0\\))가 나왔다고 가정해 보자. 그리고 홀수 번호를 받아 약물치료군에 배정된 환자 5명(B, C, F, G, I)이 실제로 약물치료를 받았을 때 3명이 생존하여 생존율이 60%(\\(0.6\\))가 나왔다고 가정해 보자. 관찰된 결과의 차이는 \\(1.0 - 0.6 = 0.4\\)이다.\n여기서 핵심은 ’만약’이라는 반사실적 상황이다. 교환가능성은 다음과 같이 설명한다.\n\n수술군에 배정된 짝수 그룹(A, D, E, H, J)이 만약 약물치료를 받았다면 어땠을까(\\(E[Y(0) | T=1]\\))? 무작위 배정 덕분에, 이 짝수 그룹의 잠재적 약물치료 결과는 실제로 약물치료를 받은 홀수 그룹(B, C, F, G, I)의 결과(\\(E[Y(0) | T=0]\\))와 평균적으로 동일할 것이라고 가정할 수 있다. 즉, 짝수 그룹이 약물치료를 받았어도 홀수 그룹과 마찬가지로 5명 중 3명이 생존하여 평균 생존율이 60%(\\(0.6\\))였을 것이라는 뜻이다.\n\n\\(E[Y(0) | T=1] = E[Y(0) | T=0]\\)\n\n좌변 \\(E[Y(0) | T=1]\\)은 수술군(\\(T=1\\))이 만약 약물치료를 받았다면 어땠을까(\\(Y(0)\\))에 대한 평균 결과를 의미한다. 이는 수술군의 관찰 불가능한 ’반사실’이다.\n우변 \\(E[Y(0) | T=0]\\)은 실제로 약물치료군(\\(T=0\\))에서 관찰된 평균 결과이다.\n즉, ’교환가능성’이란 수술군의 반사실적 결과(만약 약물치료를 받았다면 어땠을지)가 약물치료군의 사실적 결과와 같을 것이라는 강력한 가정이며, 이는 오직 무작위 배정에 의해서만 정당화될 수 있다.\n\n\n\n더 나아가, 교환가능성은 치료 배정 여부(\\(T\\))와 잠재적 결과(\\(Y(1), Y(0)\\))가 서로 독립적이라는 것을 의미하며, 이를 통계적 기호로 나타내면 다음과 같다.\n\\[(Y(1), Y(0)) \\perp T\\]\n이 독립성(교환가능성) 가정 덕분에 우리는 관찰 불가능한 평균 인과 효과를 관찰 가능한 데이터로 추정할 수 있게 된다. 그 수학적 원리는 다음과 같다.\n\n우리가 추정하고자 하는 목표는 ACE = \\(E[Y(1) - Y(0)]\\) 이다.\n기댓값의 선형성에 따라, 이는 \\(E[Y(1)] - E[Y(0)]\\) 와 같다.\n\n무작위 배정(예: 난수표를 통한 짝수/홀수 배정)으로 인해 치료 배정 여부(\\(T\\))와 잠재적 결과(\\(Y(1), Y(0)\\))는 서로 독립적이 된다. 즉, 교환가능성이 성립한다: \\((Y(1), Y(0)) \\perp T\\)\n\n이 독립성(교환가능성) 가정 덕분에, 우리는 잠재적 결과의 평균을 특정 집단에서 관찰된 결과의 평균으로 대체할 수 있다.\n\n\n\\(E[Y(1)] = E[Y(1)|T=1] = E[Y|T=1]\\) (수술의 평균 잠재 효과는 수술군에서 관찰된 평균과 같다)\n\n\\(E[Y(0)] = E[Y(0)|T=0] = E[Y|T=0]\\) (약물의 평균 잠재 효과는 약물군에서 관찰된 평균과 같다)\n\n\n따라서, 관찰이 불가능했던 목표치 \\(E[Y(1)] - E[Y(0)]\\)는 관찰 가능한 두 집단의 평균 결과 차이, 즉 \\(E[Y|T=1] - E[Y|T=0]\\) 로 계산될 수 있다.\n\n결론적으로, RCT를 통해 계산한 치료군과 대조군의 단순한 평균 결과 차이는 ’평균 인과 효과’의 편향되지 않은(unbiased) 추정치가 된다. 이처럼 RCT는 무작위 배정이라는 강력한 장치를 통해 측정되거나 측정되지 않은 모든 교란변수 문제를 원천적으로 해결하고 인과성을 명확하게 규명해주기 때문에, 인과추론 연구의 ‘황금 표준(Gold Standard)’으로 간주된다."
  },
  {
    "objectID": "posts/2025-06-27-causal/index.html#관찰-연구와-조건부-교환가능성",
    "href": "posts/2025-06-27-causal/index.html#관찰-연구와-조건부-교환가능성",
    "title": "Causal Inference (1)",
    "section": "3. 관찰 연구와 조건부 교환가능성",
    "text": "3. 관찰 연구와 조건부 교환가능성\n앞서 RCT가 인과추론의 Gold Standard임을 확인했다. 하지만 모든 임상적 질문에 RCT를 적용하는 것은 현실적으로 불가능하거나 바람직하지 않을 때가 많다. 윤리적 문제로 인해 효과가 입증된 치료를 환자에게 제공하지 않거나, 반대로 위험할 수 있는 시술에 무작위 배정할 수 없다. 수백, 수천억에 달할 수 있는 비용과 수년에 걸친 시간은 희귀 질환이나 장기적인 효과를 연구하는 데 큰 장벽이 된다. 또한, RCT는 참여 조건이 까다로워 실제 진료 현장의 다양하고 복잡한 환자군을 대표하지 못해 결과의 일반화 가능성이 떨어지는 한계도 있다.\n이러한 이유들로 인해, 연구자들은 실제 진료 환경에서 자연스럽게 축적된 방대한 데이터, 즉 RWD(Real-World Data)를 활용한 관찰 연구에 눈을 돌리게 된다. 하지만 이와 동시에 우리는 RCT의 강력한 무기였던 ’무작위 배정’을 포기해야만 하며, 이는 선택 편향(selection bias)으로 인한 교란(confounding)이라는 새로운 문제에 직면하게 만든다.\n관찰 연구에서 치료법의 선택은 연구자의 개입 없이 환자 및 임상의의 특성에 따라 자연스럽게 결정된다. 예를 들어, 특정 질환에 대해 고령의 환자는 수술의 위험 부담으로 인해 약물치료를, 상대적으로 건강한 젊은 환자는 수술을 선택하는 경향이 있을 수 있다. 이 경우, ’수술군’은 평균 연령이 낮고, ’약물치료군’은 평균 연령이 높은 두 집단이 만들어진다.\n여기서 ’나이’는 치료법 선택(고령일수록 약물치료 선호)과 결과(고령일수록 사망 위험 높음) 모두에 영향을 미치므로 교란변수(confounder)로 작용한다. 만약 두 그룹의 사망률을 단순 비교한다면, 약물치료 그룹의 사망률이 더 높게 나타날 것이다. 하지만 이 결과는 약물치료가 덜 효과적이라서가 아니라, 단지 약물치료 그룹에 나이가 많아 사망 위험이 원래 높았던 환자들이 몰려있기 때문에 발생하는 편향일 수 있다. 즉, 치료법의 효과와 나이의 효과가 뒤섞여 나타나는 것이다.\nRCT와 달리 관찰 연구에서는 치료군과 대조군이 비교 가능하지 않은, 즉 교환가능하지 않은(non-exchangeable) 상태에서 출발한다. 이처럼 ’나이’라는 교란변수 때문에 발생하는 편향을 극복하고 공정한 비교를 하기 위해, 우리는 조건부 교환가능성(Conditional Exchangeability)이라는 핵심적인 가정을 만족시켜야 한다.\n조건부 교환가능성이란, ‘비교를 왜곡하는 교란변수(X)의 값을 동일하게 고정하고 그 조건 안을 들여다보면, 두 그룹이 비로소 공정하게 비교 가능해진다’는 핵심 아이디어이다.\n가장 직관적인 예시는 ‘나이’를 기준으로 생각해보는 것이다. 전체 환자를 비교하는 대신, 오직 75세 환자들만을 모아 그 안에서 수술받은 사람과 약물치료받은 사람의 결과를 비교한다면, 적어도 ’나이’로 인한 편향은 사라진다. 이 ’나이(\\(X\\))를 75세로 고정하는(\\(\\mid X=75\\))’ 조건 하에서는 치료 선택(\\(T\\))이 환자의 잠재적 결과(\\(Y(0), Y(1)\\))와 무관해질 것이라고 가정하는 것이 바로 조건부 교환가능성이다.\n이 개념은 아래의 통계 기호로 명확하게 표현된다.\n\\[(Y(0), Y(1)) \\perp T \\mid X\\]\n이는 ’교란변수 \\(X\\)(예: 나이)의 값을 고정하면, 잠재적 결과는 실제 받은 치료와 독립적이다’라는 우리가 통계적으로 달성하고자 하는 이상적인 상태를 의미한다.\n그렇다면 이 이상적인 상태를 현실의 데이터로 어떻게 구현할 수 있을까? 바로 이 질문에 답하기 위해, ’나이’의 효과를 통제하는 다양한 통계적 방법론들이 고안되었다. 이 글에서는 그 중 하나인 회귀 분석(Regression)의 예시를 알아보겠다.\nR: 교란 효과 시뮬레이션\n\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(jstable)\nset.seed(2025)\nn &lt;- 10000\nage &lt;- runif(n, 40, 80)\nprob_med &lt;- 1 / (1 + exp(-(0.1 * (age - 60))))\ntreatment &lt;- rbinom(n, 1, prob_med)\ntreatment_fct &lt;- factor(treatment, levels = c(0, 1), labels = c(\"Surgery\", \"Medication\"))\nprob_death &lt;- 1 / (1 + exp(-(-6 + 0.08 * age)))\noutcome_death &lt;- rbinom(n, 1, prob_death)\ndf &lt;- data.table(\n  age = age,\n  treatment = treatment_fct,\n  death = outcome_death\n)\n\ncat(\"--- Descriptive Statistics by Group ---\\n\")\n\n--- Descriptive Statistics by Group ---\n\ndf %&gt;% \n  group_by(treatment) %&gt;% \n  summarise(\n    N = n(),\n    mean_age = mean(age),\n    death_rate = mean(death)\n  ) \n\n# A tibble: 2 × 4\n  treatment      N mean_age death_rate\n  &lt;fct&gt;      &lt;int&gt;    &lt;dbl&gt;      &lt;dbl&gt;\n1 Surgery     4977     54.4      0.192\n2 Medication  5023     65.5      0.347\n\nmodel_crude &lt;- glm(death ~ treatment, data = df, family = \"binomial\")\nmodel_adjusted &lt;- glm(death ~ treatment + age, data = df, family = \"binomial\")\n\nglmshow.display(model_crude)$table\n\n                                 OR.(95%CI)         P value  \ntreatment: Medication vs Surgery \"2.24 (2.04,2.45)\" \"&lt; 0.001\"\n\nglmshow.display(model_adjusted)$table\n\n                                 crude OR.(95%CI)   crude P value\ntreatment: Medication vs Surgery \"2.24 (2.04,2.45)\" \"&lt; 0.001\"    \nage                              \"1.08 (1.07,1.08)\" \"&lt; 0.001\"    \n                                 adj. OR.(95%CI)    adj. P value\ntreatment: Medication vs Surgery \"1.05 (0.95,1.17)\" \"0.356\"     \nage                              \"1.08 (1.07,1.08)\" \"&lt; 0.001\"   \n\n\n시뮬레이션 데이터의 그룹별 특성을 먼저 살펴보면, 약물치료 그룹의 평균 연령(약 65세)이 수술 그룹(약 55세)보다 약 10세 더 높고, 그에 따라 사망률 역시 현저히 높은 것을 확인할 수 있다. 이 데이터만으로 로지스틱 회귀 분석을 수행했을 때, 수술 대비 약물치료의 오즈비는 2.24로 높게 나타난다는 것을 알 수 있다. 95% 신뢰구간이 1을 훌쩍 넘어서므로, 이 결과만 보면 약물치료가 통계적으로 유의하게 사망 위험을 2배 이상 높이는 것처럼 해석된다. 하지만 이것은 ‘나이’라는 교란변수가 만들어낸 결과라는 것을 알 수 있다. 모델에 ’나이’ 변수를 추가하여 그 효과를 통계적으로 보정한 결과, 나이-보정 오즈비(Age-Adjusted Odds Ratio)는 1.05 (95% 신뢰구간: 0.95 - 1.17)로 극적으로 감소한다. 이는 통계적으로 두 치료법 간에 유의미한 사망 위험 차이가 없다는 뜻이며, ’두 치료법의 실제 효과는 동일하다’는 우리가 시뮬레이션에 설정한 진실을 정확하게 반영한다. 이처럼 교란변수 보정은 잘못된 결론을 바로잡고, 신뢰구간과 함께 결과의 불확실성을 평가함으로써 우리가 더 진실에 가까운 인과적 추론을 하도록 돕는다는 것을 알 수 있다. 이 외에도 교란변수에 대응하기 위한 다양한 통계방법들이 있다. 이는 추후 작성할 글에서 보다 자세히 알아보겠다."
  },
  {
    "objectID": "posts/2025-06-27-causal/index.html#미측정-교란변수의-한계",
    "href": "posts/2025-06-27-causal/index.html#미측정-교란변수의-한계",
    "title": "Causal Inference (1)",
    "section": "4. 미측정 교란변수의 한계",
    "text": "4. 미측정 교란변수의 한계\n’나이’처럼 우리가 측정할 수 있는 교란변수 X를 모두 통계적으로 보정했다 하더라도, 관찰 연구의 문제는 끝나지 않는다. 바로 미측정 교란변수(unmeasured confounders)의 존재 가능성이다.\n예를 들어, 환자의 ‘가정 환경 및 사회경제적 수준(SES)’이라는 변수가 있다고 가정해보자. 이 변수는 보통 병원의 데이터베이스에는 기록되지 않아 측정하기 어렵다. 하지만 SES는 다음과 같이 치료 선택과 결과 모두에 영향을 미칠 수 있다.\nSES와 치료 선택: 경제적으로 어려운 환자는 수술 후 회복 기간 동안 일을 쉬기 어려워, 회복이 빠른 약물치료를 선호할 수 있다.\nSES와 결과: 낮은 SES는 평소 영양 상태나 건강 정보에 대한 접근성이 낮아 기저 건강 상태가 좋지 않을 수 있으며, 이는 치료법과 무관하게 사망 위험을 높일 수 있다.\n이 경우 SES는 ’나이’와 마찬가지로 교란변수 역할을 하지만, 데이터에 없기 때문에 우리는 ’SES가 낮은 그룹’으로 조건을 걸어 비교하는 것이 불가능하다. 결국 SES로 인한 편향이 제거되지 않은 채 결과에 반영되고, 연구자는 SES의 효과를 약물치료의 효과로 잘못 해석할 위험에 처한다.\n\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(jstable)\nn &lt;- 10000 \nage &lt;- runif(n, 40, 80)\n\nses &lt;- rbinom(n, 1, 0.5)\n\nprob_med &lt;- 1 / (1 + exp(-(0.1 * (age - 60) -  ses)))\ntreatment &lt;- rbinom(n, 1, prob_med)\ntreatment_fct &lt;- factor(treatment, levels = c(0, 1), labels = c(\"Surgery\", \"Medication\"))\n\nprob_death &lt;- 1 / (1 + exp(-(-6 + 0.08 * age - 0.7 * ses)))\noutcome_death &lt;- rbinom(n, 1, prob_death)\n\ndf &lt;- data.table(\n  age = age,\n  ses = ses, \n  treatment = treatment_fct,\n  death = outcome_death\n)\n\nmodel_crude &lt;- glm(death ~ treatment, data = df, family = \"binomial\")\nmodel_adjusted_age_only &lt;- glm(death ~ treatment + age, data = df, family = \"binomial\")\nmodel_fully_adjusted &lt;- glm(death ~ treatment + age + ses, data = df, family = \"binomial\")\nglmshow.display(model_crude)$table\n\n                                 OR.(95%CI)         P value  \ntreatment: Medication vs Surgery \"2.31 (2.09,2.55)\" \"&lt; 0.001\"\n\nglmshow.display(model_adjusted_age_only)$table\n\n                                 crude OR.(95%CI)   crude P value\ntreatment: Medication vs Surgery \"2.31 (2.09,2.55)\" \"&lt; 0.001\"    \nage                              \"1.08 (1.08,1.09)\" \"&lt; 0.001\"    \n                                 adj. OR.(95%CI)    adj. P value\ntreatment: Medication vs Surgery \"1.13 (1.01,1.26)\" \"0.034\"     \nage                              \"1.08 (1.08,1.09)\" \"&lt; 0.001\"   \n\nglmshow.display(model_fully_adjusted)$table\n\n                                 crude OR.(95%CI)   crude P value\ntreatment: Medication vs Surgery \"2.31 (2.09,2.55)\" \"&lt; 0.001\"    \nage                              \"1.08 (1.08,1.09)\" \"&lt; 0.001\"    \nses                              \"0.55 (0.5,0.61)\"  \"&lt; 0.001\"    \n                                 adj. OR.(95%CI)    adj. P value\ntreatment: Medication vs Surgery \"0.96 (0.85,1.08)\" \"0.461\"     \nage                              \"1.09 (1.08,1.09)\" \"&lt; 0.001\"   \nses                              \"0.5 (0.45,0.56)\"  \"&lt; 0.001\"   \n\n\n이번 시뮬레이션에서는 우리가 측정할 수 없는 교란변수 ’SES’가 존재할 때 어떤 일이 발생하는지 보여준다. 이 데이터는 ’낮은 SES’가 약물치료 선택 확률과 사망 확률을 모두 높이도록, 하지만 치료법 자체의 실제 효과는 없도록(True OR = 1.0) 설계되었다.시뮬레이션 결과에서 살펴볼수 있듯이, ses라는 변수를 우리가 모르는 경우에 나이라는 알고 있는 변수를 보정하더라도 오즈비를 1.13으로 해석하여 위험비를 실제 값인 1과 다르게 해석하여 통계적으로 유의미하게 잘못된 결론을 내리게 된다는 것을 알 수 있다. 따라서 우리가 아는 교란변수를 정교하게 보정하더라도, 데이터에 없는 중요한 교란변수가 있는 경우 추정치가 진실에서 벗어난 편향된 값을 갖게 된다는 것을 알 수 있다.\n이것이 관찰 연구의 근본적인 한계이며, RCT가 Gold Standard인 이유이다. RCT에서는 무작위 배정을 통해 부유한 사람이든, 어려운 환경의 사람이든 모두가 수술군과 약물군에 확률적으로 고르게 분포하게 된다. 따라서 RCT는 우리가 사전에 인지하고 측정한 변수뿐만 아니라, 인지하지 못했거나 측정하지 못한 미지의 교란변수(SES, 유전적 특성, 성격 등)까지도 통계적으로 통제해준다. 하지만 RWD를 활용하는 관찰 연구에서는 이러한 완벽한 보장을 할 수 없으므로, 알려진 교란변수를 최대한 보정하여 최선의 추정치를 찾아내고자 노력하는 것이다."
  },
  {
    "objectID": "posts/2025-06-27-causal/index.html#시간축관련-편향-time-related-biases",
    "href": "posts/2025-06-27-causal/index.html#시간축관련-편향-time-related-biases",
    "title": "Causal Inference (1)",
    "section": "5. 시간축관련 편향 (Time-related Biases)",
    "text": "5. 시간축관련 편향 (Time-related Biases)\n지금까지 우리는 ’누구를 비교할 것인가’에 대한 문제, 즉 교란(Confounding)에 대해 집중적으로 살펴보았다. 이는 RWD 인과추론의 가장 중요하고 핵심적인 도전이다. 하지만 RWD 연구의 복잡성은 여기서 그치지 않는다. 교란만큼이나 치명적일 수 있는 두 번째 도전 과제가 남아있기 때문이다. 바로 “언제부터를 연구의 시작점(Time-zero)으로 볼 것인가?” 라는 시간축 설정의 문제이다.\nRCT에서는 모든 것이 명확하다. 환자가 연구에 동의하고 무작위 배정되는 그 순간이 모든 추적 관찰의 시작점(Time-zero)이 된다. 환자 등록(Eligibility, E), 연구 시작(Time-zero, T0), 치료 배정(Assignment, A)이 한 지점에서 동시에 일어난다. 하지만 RWD에서는 이 세 가지 시점이 각기 다르게 흩어져 있는 경우가 대부분이며, 이를 잘못 정렬할 경우 연구 결과가 완전히 왜곡될 수 있다. 실제 유명 연구 사례와 간단한 시뮬레이션을 통해 그 위험성을 살펴보자."
  },
  {
    "objectID": "posts/2025-06-27-causal/index.html#immortal-time-bias와-healthy-user-bias",
    "href": "posts/2025-06-27-causal/index.html#immortal-time-bias와-healthy-user-bias",
    "title": "Causal Inference (1)",
    "section": "5.1 Immortal Time Bias와 Healthy User Bias",
    "text": "5.1 Immortal Time Bias와 Healthy User Bias\n앞서 우리는 교란(Confounding)이라는, ’비교 대상’이 다른 문제에 대해 알아보았다. 하지만 RWD 연구에는 또 다른 큰 축의 도전 과제가 존재한다. 바로 ’비교 시점’이 다른, 시간축 설정의 문제이다.\nRCT에서는 환자 등록(Eligibility, E), 연구 시작(Time-zero, T0), 치료 배정(Assignment, A)이 ’무작위 배정’이라는 한 시점에 동시에 일어난다 (E = T0 = A). 모든 참가자가 동일한 출발선에서 경주를 시작하는 셈이다. 하지만 RWD에서는 이 세 시점이 각기 다르게 흩어져 있는 경우가 대부분이며, 이를 잘못 정렬하면 연구 결과가 완전히 왜곡될 수 있다.\n이때 발생하는 가장 대표적인 편향이 Immortal Time Bias와 Healthy User Bias이다. 이 둘은 다르지만, 매우 밀접하게 얽혀있다.\nHealthy User Bias는 Confounding의 일종이다. 특정 치료법을 사용하는 사람들이 그렇지 않은 사람들에 비해, 원래부터 더 건강하거나 건강에 대한 관심이 많은 등 근본적인 차이가 있는 현상을 말한다. Immortal Time Bias는 이러한 편향을 유발하거나 증폭시키는 동시에 시간축 설정의 구조적 오류이다.\n‘HRT(호르몬 대체 요법)’ 사례를 통해 이 둘의 관계를 살펴보자. 과거 여러 관찰 연구는 HRT가 심혈관 질환 위험을 크게 낮춘다(RR ≈ 0.6)고 보고했지만, 이후의 대규모 RCT(WHI Trial)에서는 오히려 위험을 약간 높인다(HR ≈ 1.2)는 상반된 결과를 보였다.\n이러한 불일치의 핵심 기전이 바로 ’Immortal Time’이다. ’HRT 사용자’로 연구에 포함되려면, 한 여성은 폐경(E)을 겪은 후 HRT를 실제로 처방받는 시점(A)까지, 심혈관 질환 없이 반드시 생존해야만 한다. 이 생존이 조건이 되는 기간이 바로 Immortal Time이다.\n이 생존 기간은 일종의 선별 과정으로 작용한다. 만약 질병의 위험이 초기에 가장 높다면, 이 기간 동안 상대적으로 허약한 사람들은 먼저 탈락(사건 발생)하고, 이 시기를 통과한 ‘강건한’ 생존자들만이 ‘HRT 사용자’ 그룹에 포함될 기회를 얻는다. 즉, Immortal Time이라는 구조적 장치가 ’건강한 사용자’를 인위적으로 선택해내는 편향을 유발하는 것이다.\nR : Immortal time bias의 재현\nHRT의 실제 효과가 전혀 없다고(True HR = 1.0) 가정하고, 단지 ‘초기에 위험이 높은’ 상황에서 치료 시작 시점만 환자마다 다른 경우를 시뮬레이션한다. 이 시뮬레이션은 ’건강상태’라는 변수 없이도, 생존 자체가 어떻게 선택 편향을 유발하는지 보여준다.\n\nlibrary(tidyverse)\nlibrary(survival)\nlibrary(jstable)\n\nset.seed(2025)\nn &lt;- 10000\n\n# 1. 가상의 치료군과 대조군을 1:1로 배정한다.\ngroup &lt;- rbinom(n, 1, 0.5)\n\n# 2. '초기 위험'이 높은 Weibull 분포로 생존 시간을 생성한다.\n#    shape &lt; 1 은 초기에 사망 위험(hazard)이 가장 높고,\n#    시간이 지남에 따라 위험이 감소함을 의미한다.\n#    이는 '허약한' 개체가 초기에 탈락하는 상황을 모방한다.\n#    두 그룹의 근본적인 생존 분포는 완전히 동일하게 설정한다.\ndeath_time &lt;- rweibull(n, shape = 0.7, scale = 10)\n\n# 3. 치료군(group=1)에만 치료 시작 시간을 무작위로 부여한다.\n#    치료 시작은 위험이 높은 초기 구간(e.g., 0 ~ 2.5년) 내에서 이루어진다고 가정한다.\ntx_start_time &lt;- rep(NA, n)\ntx_start_time[group == 1] &lt;- runif(sum(group == 1), 0, 2.5)\n\ndf_base &lt;- tibble(\n  id = 1:n,\n  group_true = group,\n  death_time = death_time,\n  tx_start_time = tx_start_time,\n  event = 1\n)\n\n# 4. 잘못된 분석 데이터셋을 구축 (관찰 연구의 오류 재현)\n# 4-1. 대조군(Never-treated) 데이터: 처음부터 끝까지 치료 안 받음\ndf_control &lt;- df_base %&gt;% \n  filter(group_true == 0) %&gt;%\n  mutate(fup_time = death_time, group_obs = \"Control\")\n\n# 4-2. 치료군(Treated) 데이터: '치료 시작 전 사망자'는 애초에 치료군이 될 수 없으므로 제외\ndf_treated_biased &lt;- df_base %&gt;%\n  filter(group_true == 1) %&gt;%\n  # 오류 (a): Immortal Time 동안의 사망자 제외 (선택 편향 발생)\n  # 즉, 치료 시작 전에 사망한 환자는 '치료군'에 포함될 수 없다.\n  filter(death_time &gt;= tx_start_time) %&gt;%\n  # 오류 (b): 치료 시작 시점을 새로운 Time-zero로 설정\n  mutate(fup_time = death_time - tx_start_time, group_obs = \"Treatment\")\n\n# 4-3. 두 데이터셋을 합쳐 최종 분석 데이터셋 생성\ndf_final_biased &lt;- bind_rows(\n  df_control,\n  df_treated_biased\n)\n\n# 5. 편향이 발생한 모델\nbiased_model &lt;- coxph(Surv(fup_time, event) ~ group_obs, data = df_final_biased, model = T)\ncat(\"--- Biased Analysis with Immortal Time ---\\n\")\n\n--- Biased Analysis with Immortal Time ---\n\ncox2.display(biased_model)\n\n$table\n                   HR(95%CI)          P value  \ngroup_obsTreatment \"0.87 (0.84,0.91)\" \"&lt; 0.001\"\n\n$metric\n                    [,1]               [,2]\n&lt;NA&gt;                NA                 NA  \nNo. of observations \"9009\"             NA  \nNo. of events       \"9009\"             NA  \nAIC                 \"146024.260755666\" NA  \nC-Index             \"0.525(0.003)\"     NA  \n\n$caption\n[1] \"Cox model on time ('fup_time') to event ('event')\"\n\n\n코드 해석: 이 시뮬레이션에서 치료의 실제 효과는 전혀 없도록(True HR=1.0) 설계되었다. 하지만 실제 관찰 연구에서 흔히 저지르는 오류, 즉 ‘치료 시작 전에 사망한 사람을 제외’하고 ’치료 시작 시점부터 시간을 재는’ 방식으로 데이터를 분석한 결과, 치료군의 사망 위험이 대조군에 비해 13%나 낮은 것처럼 보이는(HR ≈ 0.87) 편향이 발생했다.\n이 결과는 치료가 효과적이어서가 아니라, 치료군에 포함된 사람들이 생존이 가장 어려운 ‘초기 위험 구간’을 통과한 ’선택된 생존자’들이기 때문에 나타난 착시이다. 이처럼 Immortal Time Bias는 시간축 설정 오류를 통해 연구 집단에 선택 편향을 유발하는, 교묘한 편향의 기전임을 알 수 있다"
  },
  {
    "objectID": "posts/2025-06-27-causal/index.html#prevalent-user-bias",
    "href": "posts/2025-06-27-causal/index.html#prevalent-user-bias",
    "title": "Causal Inference (1)",
    "section": "5.2 Prevalent User Bias",
    "text": "5.2 Prevalent User Bias\n스타틴의 심혈관 질환 예방 효과를 다룬 한 유명 관찰 연구에서는 스타틴이 사망 위험을 유의미하게 낮춘다(HR ≈ 0.85)고 보고했지만, 이 역시 여러 RCT의 메타분석 결과(HR ≈ 1.00)와는 상반된 결과였다.\n이 편향의 핵심 원인은 연구 시작 시점에 이미 약물을 복용 중이던 ‘기존 사용자(Prevalent User)’를 ’비사용자’와 비교했기 때문이다. 이는 생존 편향(Survivorship Bias)을 유발하는 대표적인 연구 설계 오류이다.\n어떤 약물이든, 복용 초기에는 부작용이나 효과 부족으로 인해 복용을 중단하는 환자들이 발생한다. 특히 약물에 취약한 ‘민감한(susceptible)’ 환자들은 이 초기 단계에서 대부분 탈락할 가능성이 높다. 따라서, 오랜 기간 약물을 계속 복용하고 있는 ‘기존 사용자’들은 이 혹독한 초기 기간을 ’통과하고 살아남은’ 사람들이다. 이들은 약물에 잘 적응했거나, 원래부터 더 건강한 ‘강건한(robust)’ 환자들로 구성된 선택된(selected) 집단이다.\n이러한 ‘선택된 생존자’ 그룹을 일반적인 ‘비사용자’ 그룹과 비교하면, 두 그룹의 기저 건강상태가 근본적으로 다르기 때문에(즉, 교환가능성이 깨져있기 때문에) 약물의 안전성이나 효과가 실제보다 과대평가될 수밖에 없다.\nR : 기존 사용자 편향의 재현\n스타틴의 실제 효과는 전혀 없다고(True OR = 1.0) 가정하고, ‘민감한’ 환자들이 초기 사용 기간에 탈락하는 상황을 시뮬레이션하여 기존 사용자 그룹과 비사용자 그룹을 비교해 보자.\n\nlibrary(tidyverse)\n\nset.seed(2025)\nn &lt;- 10000\n\ninitial_users &lt;- tibble(\n  id = 1:n,\n  susceptible = rbinom(n, 1, 0.2)\n)\n\n# 1년의 \"Wash-in\" 기간 동안의 탈락 시뮬레이션\n# 민감한 그룹은 50%가 탈락, 강건한 그룹은 5%만 탈락\nprob_dropout &lt;- ifelse(initial_users$susceptible == 1, 0.5, 0.05)\nwashin_survivor_status &lt;- rbinom(n, 1, 1 - prob_dropout)\n\n# 3. t=0 시점의 두 그룹 생성\ndf_prevalent &lt;- initial_users %&gt;%\n  filter(washin_survivor_status == 1) %&gt;%\n  mutate(treatment = \"Prevalent User\")\n\ndf_non_user &lt;- tibble(\n  id = (n+1):(2*n),\n  susceptible = rbinom(n, 1, 0.2), \n  treatment = \"Non-User\"\n)\n\n\ndf_final &lt;- bind_rows(df_prevalent, df_non_user)\n\nprob_death &lt;- ifelse(df_final$susceptible == 1, 0.2, 0.05)\ndf_final$death &lt;- rbinom(nrow(df_final), 1, prob_death)\n\n# --- 분석 ---\n# 1. 두 그룹 간 '민감한' 환자 비율 비교 (교란 확인)\ncat(\"--- Proportion of Susceptible Individuals by Group ---\\n\")\n\n--- Proportion of Susceptible Individuals by Group ---\n\ndf_final %&gt;%\n  group_by(treatment) %&gt;%\n  summarise(\n    n = n(),\n    prop_susceptible = mean(susceptible)\n  ) %&gt;%\n  print()\n\n# A tibble: 2 × 3\n  treatment          n prop_susceptible\n  &lt;chr&gt;          &lt;int&gt;            &lt;dbl&gt;\n1 Non-User       10000            0.199\n2 Prevalent User  8588            0.120\n\n# 2. 로지스틱 회귀분석으로 오즈비 계산\nmodel_biased &lt;- glm(death ~ treatment, data = df_final, family = \"binomial\", model = T)\nglmshow.display(model_biased)$table\n\n                                      OR.(95%CI)        P value  \ntreatment: Prevalent User vs Non-User \"0.78 (0.7,0.87)\" \"&lt; 0.001\"\n\n\n코드 해석: 시뮬레이션의 첫 번째 결과는 두 그룹의 근본적인 차이를 명확히 보여준다. ‘비사용자’ 그룹은 설계대로 약 20%가 약물에 ‘민감한’ 환자로 구성된 반면, 초기 탈락 과정을 거친 ‘기존 사용자’ 그룹에는 ‘민감한’ 환자가 약 12%밖에 남지 않았다. 이미 출발선부터 다른, 즉 교환 가능하지 않은 두 그룹이 만들어진 것이다.\n이러한 근본적인 차이는 회귀 분석 결과에 그대로 반영된다. ‘기존 사용자’ 그룹은 ‘비사용자’ 그룹에 비해 사망에 대한 오즈비(Odds Ratio)가 약 0.78으로, 사망 위험이 20% 가량 낮은 것처럼 보이는 강력한 보호 효과를 나타낸다.\n하지만 우리는 이 약의 실제 효과가 없다는 것을 알고 있다. 이 결과는 약효 때문이 아니라, 단지 건강하고 강건한 ‘생존자’ 그룹을, 일반적인 위험도를 가진 그룹과 비교했기 때문에 발생한 통계적 착시일 뿐이다. 이는 ’기존 사용자’를 포함하는 연구 디자인의 위험성과, 비교 대상을 신중하게 선택해야 하는 이유를 명확하게 보여준다. 이러한 문제를 해결하기 위해 RWD 연구에서는 약물을 처음 사용하는 시점의 환자들만을 비교하는 ‘신규 사용자 설계(New-user Design)’가 표준적인 방법으로 권장된다."
  },
  {
    "objectID": "posts/2025-06-27-causal/index.html#결론",
    "href": "posts/2025-06-27-causal/index.html#결론",
    "title": "Causal Inference (1)",
    "section": "6 결론",
    "text": "6 결론\nRWD를 이용한 인과추론에서 교란(Confounding)의 문제와 시간축 설정(Time-related biases)의 문제에 대해서 알아보았다. 우리는 시뮬레이션을 통해, 관찰되지 않은 교란변수(Unmeasured Confounder)가 존재하거나, RWD의 본질적인 시간축 불일치 문제(Immortal Time, Prevalent User Bias)가 있을 때, 우리가 데이터에서 단순하게 관찰한 연관성(association)은 우리가 알고자 하는 참된 인과적 효과(true causal effect)와 크게 다를 수 있음을 확인했다. 이는 관찰 연구가 가진 명백하고 본질적인 한계이다. 하지만 이러한 한계를 인지하는 것이 바로 인과추론의 진정한 시작점이다. 통계학자들과 역학자들은 ’이러한 편향이 존재함을 안다면, 그 편향의 크기를 줄여 편향된 추정치(biased estimate)를 참값에 최대한 가깝게 만들 수 있지 않을까?’라는 질문에 답하기 위해 수많은 방법론을 발전시켜왔다. 앞으로 이어질 글 들에서는 해당 방법들을 보다 자세히 탐구하도록 하겠다."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "This blog focuses on statistics, R programming, and data analysis with practical applications in research.\nTopics include statistical methods, data visualization, and computational approaches to solving analytical problems."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html",
    "href": "posts/2026-01-02-propensity-score/index.html",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "",
    "text": "1편에서는 인과추론의 필요성에 대해 알아보았다. 2편에서는 실제 의학 연구에서 가장 빈번하게 마주치는 상황을 통해, 성향점수(Propensity Score)를 이용한 다양한 분석 방법론(PSM, IPTW, OW)이 어떻게 다른 결론을 도출하는지, 그리고 그 각각의 결론(ATT, ATE, ATO)이 어떤 의미를 갖는지(또 결과가 얼마나 민감한지) 파고들어 보자."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#인과-효과의-종류-estimands",
    "href": "posts/2026-01-02-propensity-score/index.html#인과-효과의-종류-estimands",
    "title": "Causal Inference (2)",
    "section": "1. 인과 효과의 종류 (Estimands)",
    "text": "1. 인과 효과의 종류 (Estimands)\n같은 약이라도 “누구에게 썼을 때의 효과인가?”에 따라 값은 달라진다. 가장 널리 쓰이는 세 가지 기본 개념과, 최근 중요해진 조건부 효과를 알아보자.\n(1) ATE (Average Treatment Effect)\n\n\n정의: 전체 모집단(Total Population)이 치료를 받았을 때와 받지 않았을 때의 결과 차이의 평균. \\[ATE = E[Y(1) - Y(0)]\\]\n\n\n해석: “무작위로 뽑은 일반인에게 이 약을 주면 효과가 있을까?”\n\n활용: 국가 보건 정책, 백신 의무화 등 전체 인구를 대상으로 한 개입을 평가할 때 주로 사용된다.\n(2) ATT (Average Treatment Effect on the Treated)\n\n\n정의: 실제로 치료를 받은 집단(Treated Group) 내에서의 효과 차이. \\[ATT = E[Y(1) - Y(0) | T=1]\\]\n\n\n해석: “이미 수술을 선택한 환자들에게, 그 수술은 약물치료보다 얼마나 나은 선택이었나?”\n\n활용: 임상 연구의 가장 주된 관심사다. 의사는 보통 진료실에 찾아온(치료를 받을 가능성이 있는) 환자들에게 관심이 있기 때문이다.\n(3) ATC (Average Treatment Effect on the Controls)\n\n\n정의: 치료를 받지 않은 집단(Control Group)이 만약 치료를 받았다면 얻었을 효과. \\[ATC = E[Y(1) - Y(0) | T=0]\\]\n\n\n활용: 흔히 쓰이지는 않으나, 치료 대상을 확대하려 할 때(예: 현재 약을 안 먹는 사람들에게도 이 약을 보험 적용해 줄 것인가?) 고려될 수 있다.\n(4) CATE (Conditional Average Treatment Effect)\n\n\n정의: 특정 공변량 \\(X\\)를 가진 하위 집단(Subgroup)에서의 효과. \\[CATE(x) = E[Y(1) - Y(0) | X=x]\\]\n\n\n활용: 정밀 의료(Precision Medicine)의 핵심이다. “전체적으로는 효과가 없지만(ATE \\(\\approx\\) 0), 특정 유전자 변이가 있는 환자군에서는 효과가 있는가?”를 탐색할 때 사용된다. 이를 통해 이질적인 치료 효과(HTE, Heterogeneity of Treatment Effect)를 파악할 수 있다."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#성향점수-propensity-score-방법론의-선택",
    "href": "posts/2026-01-02-propensity-score/index.html#성향점수-propensity-score-방법론의-선택",
    "title": "Causal Inference (2)",
    "section": "2. 성향점수 (Propensity Score) 방법론의 선택",
    "text": "2. 성향점수 (Propensity Score) 방법론의 선택\n위의 Estimand 중 무엇을 타겟으로 하느냐에 따라 분석 방법론이 결정된다. 성향점수(\\(e(X) = P(T=1|X)\\))를 활용한 대표적인 세 가지 방법을 비교해보자.\n(1) PSM (Propensity Score Matching)\n\n\nTarget: 주로 ATT\n\n\n원리: 치료군(\\(T=1\\)) 한 명당 성향점수가 비슷한 대조군(\\(T=0\\))을 1:1 또는 1:N으로 찾아 짝을 짓는다. 매칭되지 않은 대조군은 버린다(Discard).\n\n장점: 직관적이다. 공변량 균형(Balance)이 맞춰진 것을 시각적으로 확인하기 쉽다.\n\n단점: 데이터를 버리게 되어 표본 수가 줄어든다(Power 감소). 매칭 알고리즘(Greedy, Optimal 등)에 따라 결과가 달라질 수 있다.\n(2) IPTW (Inverse Probability of Treatment Weighting)\n\n\nTarget: 주로 ATE\n\n\n원리: 전체 모집단을 복원하기 위해 각 관측치에 역확률 가중치를 부여한다.\n\n\\(W_{ATE} = \\frac{T}{e(X)} + \\frac{1-T}{1-e(X)}\\)\n\n\n\n장점: 데이터를 버리지 않고 전체 표본을 활용한다.\n\n단점: Extreme Weight. 성향점수가 0이나 1에 가까운 경우 가중치가 기하급수적으로 커져(예: 100배, 1000배), 추정치의 분산(Standard Error)을 과도하게 키우고 결과를 불안정하게 만든다. 이를 완화하기 위해 Trimming(잘라내기)이나 Stabilized Weight를 쓰기도 한다.\n(3) Overlap Weighting (OW)\n\n\nTarget: ATO (Average Treatment Effect in the Overlap population)\n\n원리: 극단적인 가중치를 피하기 위해, 서로의 집단에 속할 확률을 가중치로 준다.\n\n\\(W_{ATO} = T(1-e(X)) + (1-T)e(X)\\)\n\n\n\n특징: PSM과 IPTW의 단점(데이터 손실, 가중치 폭발)을 보완하기 위해 제안된 방법이다. 분산이 가장 작아 통계적 효율성이 높다.\n\n한계: 연구 대상이 ‘임상적 균형(Clinical Equipoise)’ 상태, 즉 치료 여부가 애매한 환자들로 국한된다. 전체 인구(ATE)나 실제 치료군(ATT)과는 다른 집단을 대변하므로, 결과 해석 시 주의가 필요하다."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#r-simulation-방법론별-특징-비교",
    "href": "posts/2026-01-02-propensity-score/index.html#r-simulation-방법론별-특징-비교",
    "title": "Causal Inference (2)",
    "section": "3. R Simulation: 방법론별 특징 비교",
    "text": "3. R Simulation: 방법론별 특징 비교\n시뮬레이션을 통해 각 방법론의 특성을 살펴보자. 상황: \\(X\\)가 클수록 치료 확률이 매우 높아지는, 두 집단 간 Overlap이 부족한 상황.\n\nlibrary(tidyverse)\nlibrary(MatchIt)\nlibrary(survey)\nlibrary(sandwich)\n\nset.seed(2026)\nn &lt;- 2000\n\n# 데이터 생성: Overlap이 적은 상황 (Selection Bias 심함)\ndf &lt;- tibble(\n  X = rnorm(n),\n  # X가 크면 치료 확률 급증 -&gt; PS가 1에 가까운 사람 다수 발생\n  ps_true = plogis(0.5 + 1.2 * X),\n  T = rbinom(n, 1, ps_true),\n  # True Effect = 1.0\n  Y = 1.0 * T + 0.5 * X + rnorm(n)\n)\n\n# PS 추정\nps_model &lt;- glm(T ~ X, data = df, family = binomial)\ndf$ps_est &lt;- predict(ps_model, type = \"response\")\n\n# 분포 시각화\nggplot(df, aes(x = ps_est, fill = factor(T))) +\n  geom_density(alpha = 0.5) +\n  labs(title = \"Propensity Score Distribution (Limited Overlap)\",\n       subtitle = \"치료군(1)은 1 근처에, 대조군(0)은 0 근처에 몰려있음\") +\n  theme_minimal()\n\n\n\n\n\n\n\n(1) PSM (Target: ATT)\n\n# 1:1 Matching\nm_out &lt;- matchit(T ~ X, data = df, method = \"nearest\")\n\nWarning: Fewer control units than treated units; not all treated units will get\na match.\n\nmatched_data &lt;- match.data(m_out)\n\ncat(\"Original Sample:\", nrow(df), \"\\n\")\n\nOriginal Sample: 2000 \n\ncat(\"Matched Sample:\", nrow(matched_data), \"\\n\")\n\nMatched Sample: 1604 \n\n# 매칭되지 않은 많은 대조군 데이터가 버려짐을 확인 가능\n\n# 효과 추정\nfit_psm &lt;- lm(Y ~ T + X, data = matched_data)\ncat(\"PSM Estimate (ATT):\", coef(fit_psm)[\"T\"], \"\\n\")\n\nPSM Estimate (ATT): 1.081848 \n\n\n(2) IPTW (Target: ATE)\n\n# IPTW 가중치 계산\ndf &lt;- df %&gt;%\n  mutate(w_iptw = ifelse(T == 1, 1/ps_est, 1/(1-ps_est)))\n\n# 가중치 요약\nsummary(df$w_iptw)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.009   1.252   1.525   2.033   2.103  35.985 \n\n# Max 값이 매우 클 수 있음 (Extreme Weight 발생 가능성)\n\n# 효과 추정 (Survey 패키지 활용 권장하나 여기선 간단히 lm with weights)\nfit_iptw &lt;- lm(Y ~ T + X, data = df, weights = w_iptw)\ncat(\"IPTW Estimate (ATE):\", coef(fit_iptw)[\"T\"], \"\\n\")\n\nIPTW Estimate (ATE): 1.03698 \n\n\n(3) OW (Target: ATO)\n\n# Overlap Weighting 계산\ndf &lt;- df %&gt;%\n  mutate(w_ow = ifelse(T == 1, 1-ps_est, ps_est))\n\n# 가중치 요약 (0~1 사이로 안정적)\nsummary(df$w_ow)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n0.008719 0.201083 0.344087 0.374249 0.524384 0.972210 \n\n# 효과 추정\nfit_ow &lt;- lm(Y ~ T + X, data = df, weights = w_ow)\ncat(\"OW Estimate (ATO):\", coef(fit_ow)[\"T\"], \"\\n\")\n\nOW Estimate (ATO): 1.02632"
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#결론",
    "href": "posts/2026-01-02-propensity-score/index.html#결론",
    "title": "Causal Inference (2)",
    "section": "4. 결론",
    "text": "4. 결론\n인과추론 분석을 시작할 때 가장 먼저 해야 할 질문은 “어떤 방법론을 쓸까?”가 아니라 “나는 누구에 대한 효과를 알고 싶은가?”이다.\n\n“실제 우리 병원에서 치료받은 환자들의 경과”가 궁금하다면 ATT (PSM)가 적절할 수 있다.\n“이 치료법을 전체 인구에 확대했을 때의 효과”가 궁금하다면 ATE (IPTW)가 적절하다. 단, 극단적인 가중치(Extreme Weight) 문제에 주의해야 한다.\n두 집단 간 특성 차이가 너무 커서 비교가 어렵다면(Overlap 부족), ATO (Overlap Weighting)를 통해 비교 가능한 집단에서의 효과만이라도 안정적으로 추정하는 것이 현명한 대안이 될 수 있다.\n더 나아가, 환자 특성별로 효과가 다른지 궁금하다면 CATE를 고려해야 한다.\n\n다음 편에서는 실제 연구 데이터에서 자주 마주치는 문제인 결측치(Missing Data) 처리 방법과, 이를 인과추론 모형에 통합하는 방법에 대해 다룰 예정이다."
  },
  {
    "objectID": "의학 인과추론 보고서 작성 가이드.html",
    "href": "의학 인과추론 보고서 작성 가이드.html",
    "title": "의학 연구의 새로운 패러다임: 인과추론의 혁명과 리얼월드 근거(RWE)의 진화",
    "section": "",
    "text": "현대 의학은 증거 기반 의학(Evidence-Based Medicine, EBM)의 기치 아래 눈부신 발전을 거듭해 왔다. 지난 반세기 동안 무작위 대조 시험(Randomized Controlled Trial, RCT)은 의학적 증거의 위계에서 최상위를 점유하며, 치료의 효능과 안전성을 입증하는 ’골드 스탠다드(Gold Standard)’로서의 지위를 공고히 해왔다. 그러나 RCT는 그 엄격한 설계로 인해 높은 내부 타당도(Internal Validity)를 보장하는 반면, 막대한 비용과 시간, 윤리적 제약, 그리고 실제 임상 현장의 다양성을 충분히 반영하지 못한다는 외부 타당도(External Validity)의 한계에 직면해 있다.1 이러한 배경 속에서 리얼월드 데이터(Real-World Data, RWD)를 활용한 리얼월드 근거(Real-World Evidence, RWE)의 중요성이 대두되었으나, 관찰 데이터(Observational Data)가 내포한 편향(Bias)과 혼란(Confounding)의 문제는 오랫동안 RWE를 인과적 결론(Causal Conclusion)이 아닌 단순한 상관관계(Association)의 영역에 머물게 했다.\n그러나 최근 5년간 의학 통계와 역학 분야는 근본적인 지각 변동을 겪고 있다. 2021년 노벨 경제학상이 촉발한 ’신뢰성 혁명(Credibility Revolution)’은 관찰 데이터로부터 인과관계를 도출할 수 있는 방법론적 확신을 의학계에 심어주었으며, 이는 표적 시행 에뮬레이션(Target Trial Emulation, TTE)과 g-method와 같은 고도화된 인과추론 기법의 도입으로 이어졌다.3 이제 FDA를 비롯한 규제 당국과 NEJM, JAMA 등 주요 의학 저널들은 엄격하게 설계된 관찰 연구에 대해 조심스럽게 ’인과적 언어(Causal Language)’의 사용을 허용하기 시작했다.5\n본 보고서는 2021년 노벨 경제학상의 학술적 유산이 의학적 인과추론에 미친 영향을 시작으로, 전통적 분석 기법의 한계와 이를 극복하기 위한 최신 방법론의 이론적 배경을 상세히 기술한다. 또한, 2024-2025년 최신 문헌과 가이드라인을 통해 RWE가 실제 임상적 의사결정과 규제 과학에서 어떻게 ’인과적 증거’로서의 지위를 획득해 나가고 있는지 심층 분석한다. 이 보고서는 단순한 방법론의 나열을 넘어, 데이터 뒤에 숨겨진 인과적 구조를 파악하고 편향을 제어하려는 현대 의학의 치열한 지적 여정을 포괄적으로 조망하고자 한다.\n\n\n\n1. 2021년 노벨 경제학상의 인과추론 연구와 의학 RWE로의 확장\n\n\n2021년 스웨덴 왕립과학원은 데이비드 카드(David Card), 조슈아 앵그리스트(Joshua Angrist), 구이도 임벤스(Guido Imbens)에게 노벨 경제학상을 수여하며, 그 공로를 “자연 실험(Natural Experiment)으로부터 인과관계에 대한 결론을 도출할 수 있음을 보여준 것”으로 요약했다.3 이들의 연구는 경제학에 국한되지 않고, 실험이 불가능한 모든 사회과학 및 의학 분야에 강력한 메시지를 던졌다. 즉, 연구자가 인위적으로 무작위 배정을 하지 않더라도, 세상이 제공하는 우연한 상황—정책의 변화, 지리적 경계, 생일, 혹은 급격한 제도적 충격—이 마치 무작위 배정과 유사한 환경을 조성한다는 것이다. 이를 ’자연 실험’이라 부르며, 이를 분석하는 도구들이 의학 연구의 새로운 무기가 되었다.\n\n\n노벨상 수상자들은 인과추론을 위한 ’경제학자의 도구 상자(Economist’s Toolbox)’를 정립하였으며, 이는 다음과 같은 기법들을 통해 의학 RWE로 빠르게 이식되었다.4\n\n도구 변수 (Instrumental Variables, IV):\nRCT에서의 무작위 배정처럼, 치료 여부에는 영향을 주지만 결과에는 직접적인 영향을 주지 않는 제3의 변수(도구)를 이용하는 방법이다. 앵그리스트와 임벤스는 이를 통해 국소 평균 처치 효과(Local Average Treatment Effect, LATE)라는 개념을 정립했다.8\n\n의학적 적용: 멘델 무작위 분석(Mendelian Randomization)이 대표적이다. 유전자 변이를 도구 변수로 사용하여 특정 바이오마커와 질병 간의 인과성을 규명한다. 최근 연구에서는 병원별 처방 경향이나 지리적 거리 등을 도구 변수로 활용하여 약물의 효과를 추정한다.8\n\n\n회귀 불연속 설계 (Regression Discontinuity Design, RDD):\n특정 임계값(Cutoff)을 기준으로 치료 여부가 결정되는 상황을 이용한다. 임계값 바로 위와 아래에 있는 대상들은 임상적 특성이 거의 유사하므로(Exchangeable), 이들 간의 결과 차이는 치료에 의한 인과적 효과로 해석될 수 있다.8\n\n의학적 적용: 2024-2025년 란셋(Lancet) 등에 발표된 연구들은 바이오시밀러 강제 전환 정책이나 CD4 수치에 따른 HIV 치료 시작 시점의 효과를 분석하는 데 RDD를 적극 활용하고 있다. 예를 들어, 캐나다 브리티시컬럼비아주의 바이오시밀러 전환 정책 연구는 정책 시행일을 기준으로 전후 환자군의 결과를 비교하여, 정책이 환자의 입원율이나 응급실 방문에 인과적인 악영향을 미치지 않았음을 입증했다.9\n\n\n이중차분법 (Difference-in-Differences, DiD):\n정책이나 중재가 적용된 집단과 적용되지 않은 집단의 시간적 변화 차이를 비교하여, 시간의 흐름에 따른 자연적 변화나 집단 간의 고유한 차이를 제거한다.10\n\n\n\n\n\n노벨상 수상자들의 연구는 단순한 분석 기법의 전수를 넘어, 인과적 효과의 ’해석’에 대한 깊은 통찰을 의학계에 제공했다. 특히 앵그리스트의 LATE 개념은 의학 연구자들에게 중요한 시사점을 던진다. RCT가 주로 ’치료 의도 분석(Intention-to-Treat, ITT)’을 통해 전체 집단의 평균 효과를 추정한다면, IV 분석이나 자연 실험은 도구 변수에 반응하여 행동을 바꾼 특정 하위 집단(Compliers)에 대한 효과(LATE)를 추정한다는 점이다.8\n이는 의학 RWE에서 매우 중요하다. 예를 들어, 의사의 처방 선호도를 도구 변수로 사용한 연구에서 도출된 약물의 효과는, 의사의 선호도에 따라 처방이 바뀔 수 있는 ’한계 선상에 있는 환자(Marginal Patients)’들에게 적용되는 효과임을 이해해야 한다. 이러한 이론적 정교함은 치의학, 공중보건, 역학 분야에서 복잡한 중재 효과를 해석하는 데 필수적인 틀이 되고 있다.4\n\n\n\n2020년 이후 전 세계를 강타한 COVID-19 팬데믹은 역설적으로 의학 및 공중보건 연구에 전례 없는 자연 실험의 기회를 제공했다. 국가별로 상이한 봉쇄 정책, 백신 도입 시기, 마스크 착용 의무화 등은 연구자가 통제할 수 없는 외부 충격(External Shocks)으로서, RCT가 불가능한 비약물적 중재(NPI)의 효과를 평가하는 데 노벨상 수상자들의 방법론이 대거 적용되는 계기가 되었다.11 이 과정에서 관찰 데이터의 ’양’보다 ’설계’의 중요성이 다시금 부각되었으며, 데이터 생성 과정(Data Generating Process)에 대한 이해 없이는 빅데이터도 무용지물임이 증명되었다.\n\n\n\n\n2. 인과추론의 정의와 전통적 기법의 한계\n\n\n인과추론의 핵심은 “만약 ~하지 않았더라면(What if)”이라는 반사실적 질문에 답하는 것이다. 예르지 네이만(Jerzy Neyman)과 도널드 루빈(Donald Rubin)이 정립한 잠재적 결과 프레임워크(Potential Outcomes Framework)에 따르면, 각 개인은 치료를 받았을 때의 잠재적 결과(\\(Y^{a=1}\\))와 받지 않았을 때의 잠재적 결과(\\(Y^{a=0}\\))를 동시에 가진다.13\n인과 효과는 이 두 잠재적 결과의 차이(\\(Y^{a=1} \\- Y^{a=0}\\))로 정의된다. 그러나 현실 세계에서는 한 개인에 대해 오직 하나의 결과(사실)만 관찰할 수 있고, 다른 하나(반사실)는 영원히 결측(Missing)된다. 이를 **‘인과추론의 근본적인 문제(Fundamental Problem of Causal Inference)’**라고 한다.13 따라서 인과추론은 개별 수준이 아닌 집단 수준에서, 치료군과 대조군이 서로 ’교환 가능(Exchangeable)’하다는 가정 하에 평균 치료 효과(Average Treatment Effect, ATE)를 추정하는 통계적 과정이다.\n\n\n\nRCT는 무작위 배정을 통해 치료군과 대조군의 기저 특성(관찰된 변수 및 관찰되지 않은 변수 모두)을 통계적으로 균등하게 만듦으로써 ’교환 가능성’을 보장한다. 이로 인해 연관성(Association)이 곧 인과성(Causation)으로 성립된다.\n반면, 관찰 연구에서는 치료가 임의로 배정되지 않고 환자의 상태나 의사의 판단에 따라 결정되므로, 선택 편향(Selection Bias)과 혼란(Confounding)이 필연적으로 발생한다. 이를 극복하기 위해 전통적으로 다음과 같은 기법들이 사용되었다.\n\n성향점수 매칭 (Propensity Score Matching, PSM): 환자가 치료를 받을 확률(성향점수)을 추정하여, 점수가 유사한 환자끼리 짝을 짓는 방법이다. 이는 관찰 데이터를 마치 무작위 실험 데이터처럼 보이게 만드는(Pseudo-randomization) 효과가 있다.1\n\n다변량 회귀분석 (Multivariable Regression): 결과에 영향을 미칠 수 있는 여러 교란 요인들을 모델에 포함하여 통계적으로 보정한다.\n\n\n\n\n전통적 역학 연구에서 흔히 범하는 가장 심각한 오류 중 하나는 ’표 2의 오류’이다. 연구 논문의 두 번째 표(Table 2)에 주로 실리는 다변량 회귀분석 결과에서, 주 노출 변수뿐만 아니라 보정을 위해 포함된 다른 공변량(Covariates)들의 계수(Coefficients)까지 모두 ’서로 통제된 인과적 효과’로 해석하는 것을 말한다.16\n웨스트라이히(Westreich)와 그린란드(Greenland)가 지적한 바와 같이, 하나의 통계 모델은 특정 노출 변수(A)와 결과(Y) 사이의 인과효과를 추정하기 위해 설계된 것이다. 이때 포함된 공변량(Z)은 A의 혼란변수일 수 있지만, Z 자체의 인과효과를 추정하기에는 Z에 대한 혼란변수가 누락되었거나, Z가 매개변수 혹은 충돌변수(Collider)로 작용하여 편향을 유발할 수 있다.14\n즉, “모든 변수를 한꺼번에 넣고 돌린(Mutually adjusted)” 모델의 결과를 모두 인과적으로 해석하는 것은 수학적으로나 논리적으로 불가능하다. 각 변수의 인과효과를 알고 싶다면, 각 변수마다 고유한 인과 다이어그램(DAG)에 기반한 별도의 모델을 구축해야 한다.16 이 오류는 단순한 통계적 실수가 아니라, 데이터 생성 메커니즘에 대한 이해 부족에서 기인하는 구조적 문제다.\n\n\n\n전통적 관찰 연구, 특히 단순한 PSM이나 코호트 연구는 시간의 흐름을 잘못 다루어 심각한 편향을 초래하곤 한다.\n\n불멸의 시간 편향: 연구 시작 시점(Time Zero)과 치료 시작 시점 사이의 괴리에서 발생한다. 예를 들어, “스타틴 복용군”으로 분류되기 위해서는 처방을 받을 때까지 생존해 있어야 한다. 이 대기 기간 동안의 생존은 치료의 효과가 아님에도 불구하고 치료군의 생존 시간에 포함되어, 치료제의 효과를 과대평가하게 만든다.18\n\n우발적 사용자 편향(Prevalent User Bias): 이미 약물을 복용하고 있는 환자(Prevalent user)를 연구에 포함시킬 때 발생한다. 약물의 초기 부작용을 겪고 살아남은(적응한) 환자들만 선택되거나, 장기 복용으로 인해 기저 상태가 변한 환자들이 포함되어 인과적 추론을 왜곡한다.20\n\n이러한 전통적 기법의 한계는 단순한 통계적 보정만으로는 해결할 수 없으며, 연구 설계 자체의 근본적인 혁신을 요구하게 되었다.\n\n\n\n\n3. 전통적 한계의 극복: 표적 시행 에뮬레이션(Target Trial Emulation)\n\n\n표적 시행 에뮬레이션(Target Trial Emulation, TTE)은 하버드 대학의 미구엘 허난(Miguel Hernán)과 제임스 로빈스(James Robins)가 주창한 프레임워크로, 관찰 연구의 패러다임을 ’데이터 분석’에서 ’실험 설계’로 전환시켰다. TTE의 핵심 철학은 **“분석하려는 관찰 데이터로 수행하고 싶었던 가상의 이상적인 RCT(Target Trial)를 먼저 설계하고, 이를 관찰 데이터로 최대한 모사(Emulate)한다”**는 것이다.15\n이는 단순히 성향점수 매칭과 같은 통계 기법을 사용하는 것을 넘어, 연구의 질문(Causal Question)을 명확히 하고 설계 단계에서부터 바이어스를 구조적으로 차단하는 체계적인 접근법이다.\n\n\n\nTTE는 이상적인 RCT 프로토콜의 7가지 핵심 요소를 정의하고, 이를 관찰 데이터에 매핑하는 과정을 거친다.15\n\n\n\n\n\n\n\n\n표적 시행(Target Trial) 요소\n관찰 데이터 에뮬레이션(Emulation) 전략\n핵심 고려사항 및 해결 과제\n\n\n\n\n1. 적격성 기준 (Eligibility Criteria)\n데이터베이스 내에서 해당 임상적/인구학적 기준을 만족하는 환자 선별\nTime Zero에 기준을 만족해야 하며, 미래의 정보(예: 생존 여부)를 조건으로 삼으면 안 됨.\n\n\n2. 치료 전략 (Treatment Strategies)\n실제 처방 데이터를 기반으로 비교할 전략 정의 (예: “약물 A 시작” vs “약물 B 시작”)\n‘신규 사용자(Incident User)’ 원칙 준수. 기존 사용자는 배제하여 우발적 사용자 편향 방지.\n\n\n3. 배정 절차 (Assignment Procedures)\n무작위 배정은 불가능하므로, 교환 가능성(Exchangeability) 가정을 만족하도록 통계적 보정 수행\n성향점수(PS)나 역확률 가중치(IPW)를 사용하여 기저 특성의 균형을 맞춤.\n\n\n4. 추적 관찰 기간 (Follow-up Period)\n0시점(Time Zero)부터 결과 발생, 중도 탈락, 또는 연구 종료까지 추적\n치료군과 대조군의 Time Zero를 동기화하여 불멸의 시간 편향 차단.\n\n\n5. 결과 (Outcome)\n프로토콜에 정의된 명확한 임상적 결과 정의\n측정 오차(Measurement Error) 및 정보 편향 주의.\n\n\n6. 인과적 대비 (Causal Contrast)\nITT(치료 의도) 효과 또는 Per-Protocol(순응도 고려) 효과 선택\n관찰 연구에서는 실제 처방이 변경될 수 있으므로, 연구 목적에 맞는 효과(Estimand)를 명확히 정의해야 함.\n\n\n7. 분석 계획 (Analysis Plan)\n결과 모델링 및 인과 효과 추정 (예: Cox 모델, g-formula 등)\n선택 편향과 정보 편향을 보정하기 위한 구체적인 통계적 방법론 명시.\n\n\n\n\n\n\nTTE는 전통적 기법이 해결하지 못한 난제들을 설계적으로 해결한다.\n\nTime Zero의 동기화와 불멸의 시간 편향 제거:\nTTE는 모든 환자가 적격성 기준을 충족하고 치료 전략이 시작되는 시점을 ’0시점’으로 엄격하게 정의한다. 예를 들어, “진단 후 30일 이내 투여”와 같이 조건을 명시하여, 치료를 받기 위해 기다리는 대기 시간을 치료군의 생존 시간에 포함시키지 않도록 한다. 최근 스타틴과 치매 연구에서, TTE를 적용하여 불멸의 시간 편향을 제거한 결과 스타틴의 예방 효과가 과장되었을 가능성이 확인되었다.19\n\n클로닝(Cloning)과 검열(Censoring):\n“진단 후 3개월 이내에 치료를 시작하는 군”과 같은 동적 치료 전략을 비교할 때, 환자는 3개월이 되기 전까지는 어느 군에 속할지 알 수 없다. TTE는 이 기간 동안 환자의 데이터를 복제(Clone)하여 두 전략 모두에 할당한 뒤, 실제 치료 여부가 결정되는 순간 프로토콜과 일치하지 않는 복제본을 인공적으로 검열(Censoring)하는 기법을 사용한다.19 이는 수학적으로 무결한 비교를 가능하게 한다.\n\n신규 사용자 설계(New User Design):\nRCT와 마찬가지로 연구 시작 시점에 해당 약물을 처음 사용하는 환자만을 포함시킴으로써, 약물에 이미 적응한 환자만 남는 선택 편향을 방지한다.24\n\n\n\n\n2024-2025년 발표된 주요 연구들은 TTE의 위력을 보여준다.\n\nGLP-1과 심혈관 질환: 비만 환자에서 GLP-1 수용체 작용제의 심혈관 및 신장 보호 효과를 분석한 연구는 TTE 설계를 통해 RCT인 SELECT 연구와 매우 유사한 결과를 도출해냈다. 이는 RWE가 잘 설계될 경우 RCT를 대체하거나 보완할 수 있음을 시사한다.24\n\n스타틴과 치매: 과거 관찰 연구들이 스타틴의 치매 예방 효과를 일관되게 보여주지 못한 것은 불멸의 시간 편향 때문이었다. 최신 TTE 연구들은 이러한 편향을 제거하고, 로수바스타틴(Rosuvastatin) 등 특정 스타틴이 실제로 치매 위험을 낮출 가능성을 보다 정교하게 제시하고 있다.26\n\n\n\n\n\n4. 복잡성의 정복: g-method의 이론과 실제\n\n\n만성 질환(당뇨병, HIV, 암 등) 연구에서는 환자의 상태가 변함에 따라 치료가 변경되고, 그 치료가 다시 환자의 상태에 영향을 미치는 과정이 수년간 반복된다. 이때 CD4 수치나 당화혈색소(HbA1c)와 같은 변수는 **‘혼란변수(Confounder)’**이자 동시에 **‘이전 치료의 결과(Mediator)’**라는 이중적 지위를 갖는다.28\n이러한 상황에서 전통적인 회귀분석(Cox 모델 등)을 사용하여 해당 변수를 보정(Adjust)하면 심각한 문제가 발생한다.\n\n과잉 보정(Over-adjustment): 치료가 매개변수를 통해 결과에 미치는 간접 효과까지 제거해버려, 총 효과(Total Effect)를 과소추정하게 된다.\n\n충돌변수 편향(Collider Bias): 매개변수를 통제함으로써, 치료와 결과 사이에 존재하지 않던 가짜 연관성을 생성해낼 수 있다.16\n\n이를 해결하기 위해 제임스 로빈스는 1986년 g-method군을 개발하였으며, 이는 현대 인과추론의 정점으로 평가받는다.\n\n\n\n\n\nIPW는 각 시점별로 환자가 실제로 받은 치료를 받을 확률(성향점수)을 계산하고, 그 역수를 가중치로 부여한다.\n\n원리: 가중치를 적용하면, 마치 모든 환자가 무작위로 치료를 받은 것과 같은 **가상의 모집단(Pseudo-population)**이 생성된다. 이 가상 집단에서는 혼란변수와 치료 간의 연결고리가 끊어지므로, 매개변수를 직접 보정하지 않고도 인과 효과를 추정할 수 있다.28\n\n적용: 치료 순응도가 시간에 따라 변하는 연구에서 ‘순응했다면(Per-protocol)’ 효과를 추정하는 데 표준적으로 사용된다.\n\n\n\n\ng-formula는 관찰된 데이터를 기반으로, 특정 중재 시나리오 하에서의 결과를 **시뮬레이션(Simulation)**하는 기법이다.\n\n원리: (1) 공변량, 치료, 결과 간의 관계를 모델링한 후, (2) 몬테카를로 시뮬레이션 등을 통해 “만약 모든 환자가 5년간 약물 A를 지속적으로 복용했다면?”과 같은 반사실적 데이터를 생성한다. (3) 이를 “약물 B를 복용했다면?”의 시나리오와 비교한다.28\n\n장점: 단순한 치료 비교를 넘어, “당화혈색소가 7.0% 이상일 때만 인슐린을 시작한다”와 같은 복잡한 **동적 치료 전략(Dynamic Treatment Regimes)**을 비교하는 데 독보적이다.\n\n최신 사례: 2025년 발표된 천식 치료 궤적 연구와 당뇨병 환자의 혈당 변동성 연구는 g-formula를 사용하여 장기간의 치료 경로와 결과를 성공적으로 시뮬레이션하고 인과 효과를 추정했다.32\n\n\n\n\n주로 생존 분석이나 중도 절단(Censoring)이 심한 데이터에서 사용되며, 모델의 가정에 덜 민감하고(Robust) 효과의 이질성(Effect Modification)을 탐지하는 데 유리하다.34\n\n\n\n\n\n\n\n\n\n\n\n\n특징\n전통적 회귀분석 (Cox, Logistic)\ng-method (IPW, g-formula)\n\n\n\n\n교란 요인 처리 방식\n모델에 변수로 포함 (Conditioning)\n가중치 부여(IPW) 또는 시뮬레이션(g-formula)\n\n\n피드백 루프 대응\n불가능. 매개변수이기도 한 교란 요인을 보정 시 편향 발생 (Null Paradox 등).\n가능. 교란 경로를 차단하거나(IPW) 표준화(Standardization)하여 총 효과를 정확히 추정.\n\n\n결과 해석\n조건부 연관성 (Conditional Association)\n인과적 효과 (Marginal Causal Effect)\n\n\n주요 적용 대상\n단일 시점 노출, 고정된 교란 요인\n만성 질환의 장기 추적, 치료 변경이 빈번한 연구\n\n\n\n\n\n\n\n5. 규제 과학과 보고 표준: ’인과적 언어’의 시민권 획득\n\n\n미국 FDA는 21세기 치료법(21st Century Cures Act)에 따라 RWE를 규제 의사결정에 활용하기 위한 노력을 지속해 왔으며, 2023년 초안을 거쳐 2024-2025년에 걸쳐 **비중재적 연구(Non-interventional Studies)**에 대한 가이드라인을 확정 짓고 있다.6 FDA의 입장은 “RWE는 더 이상 단순한 보조 자료가 아니다”라는 것으로 요약된다.\n\n적합성(Fitness for Use): FDA는 데이터가 신뢰성(Reliability)(정확성, 완전성, 추적 가능성)과 관련성(Relevance)(주요 변수 포함 여부, 대표성)을 갖춰야 함을 명시했다. 특히 EHR이나 청구 데이터의 품질을 평가하는 구체적인 기준을 제시하고 있다.6\n\n사전 설계(Prespecification) 의무화: 관찰 연구의 고질적 문제인 ’데이터 마이닝(Data Dredging)’과 ’P-hacking’을 방지하기 위해, 연구 수행 전(데이터를 열어보기 전)에 프로토콜과 분석 계획을 확정하고 FDA와 협의할 것을 강력히 권고한다. 이때 TTE 프레임워크의 사용이 사실상 표준으로 자리 잡고 있다.6\n\n인과추론의 수용: 적절한 설계(TTE 등)와 분석(g-method 등)이 뒷받침된다면, 비중재적 연구로도 약물의 유효성과 안전성에 대한 인과적 결론을 내릴 수 있음을 인정하는 추세다.\n\n\n\n\n2025년 9월, JAMA와 BMJ, PLOS Medicine 등 주요 저널에 동시에 게재된 **TARGET 성명서(Transparent Reporting of Observational Studies Emulating a Target Trial)**는 RWE 연구 보고의 투명성을 획기적으로 높이기 위한 국제적 합의다.36\nTARGET은 기존의 STROBE 가이드라인이 해결하지 못한 ’인과추론 연구의 특수성’을 반영한다. 21개 항목으로 구성된 체크리스트는 연구자에게 다음을 요구한다.\n\n연구가 에뮬레이션하고자 하는 가상의 표적 시행 프로토콜을 명시적으로 기술할 것.\n\n실제 관찰 데이터가 이 프로토콜의 각 요소(적격성, 치료, 추적 관찰 등)와 어떻게 **매핑(Mapping)**되는지를 상세히 보고할 것.\n\n잔존하는 교란 요인(Residual Confounding)과 에뮬레이션 실패 가능성을 투명하게 논의할 것.\n\n이는 독자와 리뷰어가 연구의 설계상 오류(예: 불멸의 시간 편향)를 쉽게 식별할 수 있게 하며, 관찰 연구가 RCT에 준하는 엄격함을 갖추도록 강제하는 효과가 있다.37\n\n\n\n과거 의학 저널, 특히 NEJM이나 JAMA는 관찰 연구에서 ‘영향을 미친다(Effect)’, ’감소시킨다(Reduce)’와 같은 인과적 단어 사용을 엄격히 금지하고, ’관련이 있다(Associated with)’라는 표현만을 허용했다. 이는 관찰 연구의 내재적 편향에 대한 방어기제였다.\n그러나 최근 TTE와 같은 엄격한 방법론이 적용된 연구에 대해서는 이러한 제한이 완화되고 있다. 연구자들은 이제 설계가 견고하다면 “A가 B의 위험을 낮추는 것으로 추정된다”와 같은 인과적 표현을 사용할 수 있다.5\n하지만 동시에 **‘인과적 언어 비약(Causal Language Jump)’**에 대한 경계심도 높아지고 있다. 이는 연구 본문에서는 조심스럽게 상관관계로 기술하고 결론이나 가이드라인에서는 강력한 인과관계로 둔갑시키는 현상을 말한다. 최근 연구들은 가이드라인의 권고안이 원본 연구의 근거 수준보다 더 강한 인과적 주장을 하는 경향이 있음을 지적하며, 근거와 주장 사이의 일치성을 강조하고 있다.5\n\n\n\n\n6. 최신 RWE 사례 분석: 이론의 실전 적용 (2024-2025)\n\n\n2024년 발표된 세마글루타이드(GLP-1 제제)가 제2형 당뇨병 환자의 알츠하이머병(AD) 위험을 감소시키는지를 분석한 RWE 연구는 TTE 적용의 명과 암을 보여주는 대표적 사례다.23\n\n연구 설계: 연구팀은 TTE 프레임워크를 적용하여, 세마글루타이드 신규 사용자(Initiators)와 다른 당뇨병 약물(인슐린, 메트포르민 등) 신규 사용자를 비교했다. 3년의 추적 관찰 기간 동안 세마글루타이드 사용군에서 AD 발병 위험이 유의하게 낮음을 보고했다.\n\n성과: RCT가 아직 완료되지 않은 상황에서 시의적절한 근거를 제공했으며, TTE를 통해 불멸의 시간 편향 등을 제어하려는 노력이 돋보였다.\n\n논쟁과 교훈: 그러나 비평가들은 대조군 설정의 문제점을 지적했다. 인슐린 사용자는 일반적으로 당뇨병 진행이 더 많이 된 환자군이므로, 기저 질환의 중증도가 세마글루타이드군보다 높을 수밖에 없다(Confounding by indication). 성향점수 매칭을 했더라도 측정되지 않은 중증도 차이가 잔존할 수 있다는 것이다.41 이는 TTE가 설계적 오류(Design flaw)는 해결해 주지만, 데이터 자체의 한계(Data limitation)나 임상적 맥락을 무시한 비교까지 해결해 주지는 못함을 시사한다.\n\n\n\n\n캐나다 브리티시컬럼비아주에서 시행된 바이오시밀러 강제 전환 정책을 평가한 연구는 노벨상 수상 방법론인 RDD를 의학 정책 평가에 적용한 모범 사례다.9\n\n방법론: 정책 시행일(Cutoff)을 기준으로, 그 직전에 약물을 시작한 환자와 직후에 시작한 환자를 비교했다. 이들은 시간적으로 매우 인접해 있어 임상적 특성이 거의 동일하므로(Locally Randomized), 정책 시행 전후의 결과 차이를 정책의 인과적 효과로 해석할 수 있다.\n\n결과: 연구 결과, 정책 시행이나 바이오시밀러 사용이 환자의 입원율이나 응급실 방문 증가와 인과적인 관련이 없음을 밝혀냈다. 이는 RCT 없이도 정책의 안전성을 입증한 강력한 RWE 사례로 꼽힌다.\n\n\n\n\n\n결론 및 제언\n2021년 노벨 경제학상이 촉발한 인과추론의 혁명은 의학 연구의 지형을 근본적으로 변화시켰다. ‘연관성’의 시대는 저물고, 이제 의학 연구자들은 관찰 데이터로부터 **’인과성’**을 추출해내기 위한 정교한 공학적 접근을 요구받고 있다. 표적 시행 에뮬레이션(TTE)은 단순한 분석 도구가 아니라 연구를 바라보는 세계관(Mindset)의 전환이며, g-method는 복잡한 현실 세계의 치료 과정을 수학적으로 풀어내는 열쇠다.\nTARGET 성명서의 발표와 FDA 가이드라인의 고도화는 이러한 방법론들이 더 이상 학문적 유희가 아니라, 환자의 생명과 직결된 의사결정의 표준이 되었음을 의미한다. 그러나 세마글루타이드 연구의 논쟁에서 보듯이, 아무리 훌륭한 방법론도 임상적 맥락에 대한 깊은 이해와 고품질의 데이터 없이는 사상누각에 불과하다.\n앞으로의 의학 연구는 **“어떻게 하면 관찰 데이터를 무작위 실험처럼 다룰 수 있을 것인가?”**라는 질문에 답하기 위해, 데이터 과학, 역학, 그리고 임상의학이 융합된 고도의 인과추론 설계를 지향해야 할 것이다. 이것이 바로 리얼월드 데이터가 진정한 리얼월드 근거로 거듭나는 길이다.\n– 부록 내가 할거\nConfounder와 collider 어떻게 선택할것인가? 이거랑\n막판에 머신러닝 관련된 부분 넣기 interaction이런게 생각보다 중요한 변수이니까\n\n\n\nEmulating Clinical Trials with the Mayo Clinic Platform: Cardiovascular Research Perspective - medRxiv, 1월 2, 2026에 액세스, https://www.medrxiv.org/content/10.1101/2025.03.19.25324271v1.full.pdf\n\nConducting observational analyses with the target trial emulation approach: a methodological systematic review | BMJ Open, 1월 2, 2026에 액세스, https://bmjopen.bmj.com/content/bmjopen/14/11/e086595.full.pdf\n\nCausal Inference: Onward and Upward! - PubMed, 1월 2, 2026에 액세스, https://pubmed.ncbi.nlm.nih.gov/35311410/\n\nCausal Inference: Onward and Upward! - PMC, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC9260467/\n\nCausal language jumps in clinical practice guidelines for diabetes management - arXiv, 1월 2, 2026에 액세스, https://arxiv.org/html/2503.03557v1\n\nReal-World Evidence: Considerations Regarding Non … - FDA, 1월 2, 2026에 액세스, https://www.fda.gov/media/177128/download\n\nMendelian Randomization Methods for Causal Inference: Estimands, Identification and Inference - arXiv, 1월 2, 2026에 액세스, https://arxiv.org/pdf/2509.11519\n\nMultiple discoveries in causal inference: LATE for the party - PMC - NIH, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC11218811/\n\nThe impact of biosimilar use on healthcare utilization among new …, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC12017995/\n\nFull article: Empowering leadership in crisis: a natural experiment - Taylor & Francis, 1월 2, 2026에 액세스, https://www.tandfonline.com/doi/full/10.1080/14719037.2025.2459162\n\nNatural experiments: A Nobel Prize awarded research design for strengthening causal inference on global health challenges, 1월 2, 2026에 액세스, https://jogh.org/wp-content/uploads/2022/04/jogh-12-03005.pdf\n\n(PDF) Natural experiments: A Nobel Prize awarded research design for strengthening causal inference on global health challenges - ResearchGate, 1월 2, 2026에 액세스, https://www.researchgate.net/publication/360243525_Natural_experiments_A_Nobel_Prize_awarded_research_design_for_strengthening_causal_inference_on_global_health_challenges\n\nHow to select predictive models for decision-making or causal inference - Oxford Academic, 1월 2, 2026에 액세스, https://academic.oup.com/gigascience/article/doi/10.1093/gigascience/giaf016/8089999\n\nConcepts (R) – Advanced Epidemiological Methods, 1월 2, 2026에 액세스, https://ehsanx.github.io/EpiMethods/confounding0.html\n\nTarget Trial Emulation: A Framework for Causal RWE | IntuitionLabs, 1월 2, 2026에 액세스, https://intuitionlabs.ai/articles/target-trial-emulation-rwe\n\nUsing causal diagrams and multiple comparison … - medRxiv, 1월 2, 2026에 액세스, http://medrxiv.org/cgi/reprint/2024.02.26.24303405v1\n\nRevisiting the Table 2 Fallacy: A Motivating Example Examining Preeclampsia and Preterm Birth - PubMed Central, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC6103824/\n\nOpportunities, challenges and future perspectives for target trial emulation in critical care clinical research - NIH, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC12613904/\n\nTarget trial emulation framework: mitigating methodological challenges and application in COVID-19 treatment evaluation studies | Request PDF - ResearchGate, 1월 2, 2026에 액세스, https://www.researchgate.net/publication/391299562_Target_trial_emulation_framework_mitigating_methodological_challenges_and_application_in_COVID-19_treatment_evaluation_studies\n\nTarget Trial Emulation: A Primer on Improving Observational Research in Neurology, 1월 2, 2026에 액세스, https://www.neurology.org/doi/10.1212/WNL.0000000000214269\n\nThe target trial framework for causal inference from observational data: Why and when is it helpful? - PMC - NIH, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC11936718/\n\nExternal comparator studies and the joint application of the estimand and target trial emulation frameworks - Frontiers, 1월 2, 2026에 액세스, https://www.frontiersin.org/journals/drug-safety-and-regulation/articles/10.3389/fdsfr.2024.1409102/full\n\nTarget trial emulation to reduce confounding in therapy effectiveness assessment - (Based on the Cohort Study by Wang et al. on Semaglutide and Opioid Overdose Risk in Patients With Type 2 Diabetes and Opioid Use Disorder) | Sciety, 1월 2, 2026에 액세스, https://sciety.org/articles/activity/10.31219/osf.io/mwthq_v1\n\nCardiovascular and kidney outcomes of GLP-1 receptor agonists in adults with obesity: A target trial emulation study - PubMed, 1월 2, 2026에 액세스, https://pubmed.ncbi.nlm.nih.gov/40874398/\n\n1A-03 - Primary Prevention of Cardiovascular and Renal Outcomes with GLP-1 Receptor Agonists in Adults with Obesity: A Target Trial Emulation Study - 2025 ISPE Annual Meeting, 1월 2, 2026에 액세스, https://2025ispe.eventscribe.net/ajaxcalls/PresentationInfo.asp?PresentationID=1653403\n\nAssociation of Different Statins with Incident ADRD: A Target Trial Emulation Study, 1월 2, 2026에 액세스, https://www.researchgate.net/publication/399090145_Association_of_Different_Statins_with_Incident_ADRD_A_Target_Trial_Emulation_Study\n\nStatin Initiation and Dementia Incidence in a Large Health Care System From 1997 to 2020: A Target Trial Emulation Study - PubMed Central, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC12205742/\n\nTime-Varying Confounding: A Summary of Key Ideas and Frequently …, 1월 2, 2026에 액세스, https://evidenceforaction.org/time-varying-confounding-summary-key-ideas-and-frequently-asked-questions\n\nG-methods in the existence of time varying confounding, 1월 2, 2026에 액세스, https://zhjbkz.ahmu.edu.cn/en/article/doi/10.16462/j.cnki.zhjbkz.2021.06.002\n\nTime-Varying Confounding - Evidence for Action, 1월 2, 2026에 액세스, https://evidenceforaction.org/sites/default/files/2021-05/E4A-TVC-Methods-Note.pdf\n\nThe Parametric g-Formula for Time-to-event Data - CDC Stacks, 1월 2, 2026에 액세스, https://stacks.cdc.gov/view/cdc/201397/cdc_201397_DS1.pdf\n\nModelling Asthma Treatment Dynamics: Insights from the g-Formula - PMC - NIH, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC11913031/\n\nLong-term glycemic variability and the risk of cardiovascular diseases in type 2 diabetic patients: Effect of hypothetical interventions using parametric g-formula in a population-based historical cohort study | PLOS One, 1월 2, 2026에 액세스, https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0319975\n\nUsing generalized linear models to implement g-estimation for survival data with time-varying confounding - PubMed Central, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC7612171/\n\nUse of Real-World Evidence To Support Regulatory Decision-Making for Medical Devices; Guidance for Industry and Food and Drug Administration Staff; Availability - Federal Register, 1월 2, 2026에 액세스, https://www.federalregister.gov/documents/2025/12/18/2025-23252/use-of-real-world-evidence-to-support-regulatory-decision-making-for-medical-devices-guidance-for\n\nTARGET 2025 Guidelines Published in JAMA | Harvard T.H. Chan School of Public Health, 1월 2, 2026에 액세스, https://hsph.harvard.edu/causalab/news/target-2025-guidelines-published-in-jama/\n\nTransparent reporting of observational studies emulating a target trial - The BMJ, 1월 2, 2026에 액세스, https://www.bmj.com/content/390/bmj-2025-087179.full.pdf\n\nTransparent Reporting of Observational Studies Emulating a Target Trial-The TARGET Statement - PubMed, 1월 2, 2026에 액세스, https://pubmed.ncbi.nlm.nih.gov/40899949/\n\nFrom emulation to evidence: The concepts, limitations, and prospects of TTE and TARGET, 1월 2, 2026에 액세스, https://www.the-innovation.org/article/doi/10.59717/j.xinn-med.2025.100172\n\nQuality of causality assessment among observational studies in intensive care: A methodological review | Request PDF - ResearchGate, 1월 2, 2026에 액세스, https://www.researchgate.net/publication/395161889_Quality_of_causality_assessment_among_observational_studies_in_intensive_care_A_methodological_review\n\nComment on “Associations of semaglutide with first‐time diagnosis of Alzheimer’s disease in patients with type 2 diabetes: Target trial emulation using nationwide real‐world data in the US” - PMC - PubMed Central, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC12069008/\n\nASSOCIATIONS OF SEMAGLUTIDE WITH ALZHEIMER’S DISEASE-RELATED DEMENTIAS IN PATIENTS WITH TYPE 2 DIABETES: A REAL-WORLD TARGET TRIAL EMULATION STUDY - Chiro.org, 1월 2, 2026에 액세스, https://chiro.org/Graphics_Box_NUTRITION/ABSTRACTS/Associations_of_Semaglutide_With_Alzheimers.shtml"
  },
  {
    "objectID": "의학 인과추론 보고서 작성 가이드.html#서론-상관관계를-넘어-인과성의-시대로",
    "href": "의학 인과추론 보고서 작성 가이드.html#서론-상관관계를-넘어-인과성의-시대로",
    "title": "의학 연구의 새로운 패러다임: 인과추론의 혁명과 리얼월드 근거(RWE)의 진화",
    "section": "",
    "text": "현대 의학은 증거 기반 의학(Evidence-Based Medicine, EBM)의 기치 아래 눈부신 발전을 거듭해 왔다. 지난 반세기 동안 무작위 대조 시험(Randomized Controlled Trial, RCT)은 의학적 증거의 위계에서 최상위를 점유하며, 치료의 효능과 안전성을 입증하는 ’골드 스탠다드(Gold Standard)’로서의 지위를 공고히 해왔다. 그러나 RCT는 그 엄격한 설계로 인해 높은 내부 타당도(Internal Validity)를 보장하는 반면, 막대한 비용과 시간, 윤리적 제약, 그리고 실제 임상 현장의 다양성을 충분히 반영하지 못한다는 외부 타당도(External Validity)의 한계에 직면해 있다.1 이러한 배경 속에서 리얼월드 데이터(Real-World Data, RWD)를 활용한 리얼월드 근거(Real-World Evidence, RWE)의 중요성이 대두되었으나, 관찰 데이터(Observational Data)가 내포한 편향(Bias)과 혼란(Confounding)의 문제는 오랫동안 RWE를 인과적 결론(Causal Conclusion)이 아닌 단순한 상관관계(Association)의 영역에 머물게 했다.\n그러나 최근 5년간 의학 통계와 역학 분야는 근본적인 지각 변동을 겪고 있다. 2021년 노벨 경제학상이 촉발한 ’신뢰성 혁명(Credibility Revolution)’은 관찰 데이터로부터 인과관계를 도출할 수 있는 방법론적 확신을 의학계에 심어주었으며, 이는 표적 시행 에뮬레이션(Target Trial Emulation, TTE)과 g-method와 같은 고도화된 인과추론 기법의 도입으로 이어졌다.3 이제 FDA를 비롯한 규제 당국과 NEJM, JAMA 등 주요 의학 저널들은 엄격하게 설계된 관찰 연구에 대해 조심스럽게 ’인과적 언어(Causal Language)’의 사용을 허용하기 시작했다.5\n본 보고서는 2021년 노벨 경제학상의 학술적 유산이 의학적 인과추론에 미친 영향을 시작으로, 전통적 분석 기법의 한계와 이를 극복하기 위한 최신 방법론의 이론적 배경을 상세히 기술한다. 또한, 2024-2025년 최신 문헌과 가이드라인을 통해 RWE가 실제 임상적 의사결정과 규제 과학에서 어떻게 ’인과적 증거’로서의 지위를 획득해 나가고 있는지 심층 분석한다. 이 보고서는 단순한 방법론의 나열을 넘어, 데이터 뒤에 숨겨진 인과적 구조를 파악하고 편향을 제어하려는 현대 의학의 치열한 지적 여정을 포괄적으로 조망하고자 한다."
  },
  {
    "objectID": "의학 인과추론 보고서 작성 가이드.html#section",
    "href": "의학 인과추론 보고서 작성 가이드.html#section",
    "title": "의학 연구의 새로운 패러다임: 인과추론의 혁명과 리얼월드 근거(RWE)의 진화",
    "section": "",
    "text": "1. 2021년 노벨 경제학상의 인과추론 연구와 의학 RWE로의 확장\n\n\n2021년 스웨덴 왕립과학원은 데이비드 카드(David Card), 조슈아 앵그리스트(Joshua Angrist), 구이도 임벤스(Guido Imbens)에게 노벨 경제학상을 수여하며, 그 공로를 “자연 실험(Natural Experiment)으로부터 인과관계에 대한 결론을 도출할 수 있음을 보여준 것”으로 요약했다.3 이들의 연구는 경제학에 국한되지 않고, 실험이 불가능한 모든 사회과학 및 의학 분야에 강력한 메시지를 던졌다. 즉, 연구자가 인위적으로 무작위 배정을 하지 않더라도, 세상이 제공하는 우연한 상황—정책의 변화, 지리적 경계, 생일, 혹은 급격한 제도적 충격—이 마치 무작위 배정과 유사한 환경을 조성한다는 것이다. 이를 ’자연 실험’이라 부르며, 이를 분석하는 도구들이 의학 연구의 새로운 무기가 되었다.\n\n\n노벨상 수상자들은 인과추론을 위한 ’경제학자의 도구 상자(Economist’s Toolbox)’를 정립하였으며, 이는 다음과 같은 기법들을 통해 의학 RWE로 빠르게 이식되었다.4\n\n도구 변수 (Instrumental Variables, IV):\nRCT에서의 무작위 배정처럼, 치료 여부에는 영향을 주지만 결과에는 직접적인 영향을 주지 않는 제3의 변수(도구)를 이용하는 방법이다. 앵그리스트와 임벤스는 이를 통해 국소 평균 처치 효과(Local Average Treatment Effect, LATE)라는 개념을 정립했다.8\n\n의학적 적용: 멘델 무작위 분석(Mendelian Randomization)이 대표적이다. 유전자 변이를 도구 변수로 사용하여 특정 바이오마커와 질병 간의 인과성을 규명한다. 최근 연구에서는 병원별 처방 경향이나 지리적 거리 등을 도구 변수로 활용하여 약물의 효과를 추정한다.8\n\n\n회귀 불연속 설계 (Regression Discontinuity Design, RDD):\n특정 임계값(Cutoff)을 기준으로 치료 여부가 결정되는 상황을 이용한다. 임계값 바로 위와 아래에 있는 대상들은 임상적 특성이 거의 유사하므로(Exchangeable), 이들 간의 결과 차이는 치료에 의한 인과적 효과로 해석될 수 있다.8\n\n의학적 적용: 2024-2025년 란셋(Lancet) 등에 발표된 연구들은 바이오시밀러 강제 전환 정책이나 CD4 수치에 따른 HIV 치료 시작 시점의 효과를 분석하는 데 RDD를 적극 활용하고 있다. 예를 들어, 캐나다 브리티시컬럼비아주의 바이오시밀러 전환 정책 연구는 정책 시행일을 기준으로 전후 환자군의 결과를 비교하여, 정책이 환자의 입원율이나 응급실 방문에 인과적인 악영향을 미치지 않았음을 입증했다.9\n\n\n이중차분법 (Difference-in-Differences, DiD):\n정책이나 중재가 적용된 집단과 적용되지 않은 집단의 시간적 변화 차이를 비교하여, 시간의 흐름에 따른 자연적 변화나 집단 간의 고유한 차이를 제거한다.10\n\n\n\n\n\n노벨상 수상자들의 연구는 단순한 분석 기법의 전수를 넘어, 인과적 효과의 ’해석’에 대한 깊은 통찰을 의학계에 제공했다. 특히 앵그리스트의 LATE 개념은 의학 연구자들에게 중요한 시사점을 던진다. RCT가 주로 ’치료 의도 분석(Intention-to-Treat, ITT)’을 통해 전체 집단의 평균 효과를 추정한다면, IV 분석이나 자연 실험은 도구 변수에 반응하여 행동을 바꾼 특정 하위 집단(Compliers)에 대한 효과(LATE)를 추정한다는 점이다.8\n이는 의학 RWE에서 매우 중요하다. 예를 들어, 의사의 처방 선호도를 도구 변수로 사용한 연구에서 도출된 약물의 효과는, 의사의 선호도에 따라 처방이 바뀔 수 있는 ’한계 선상에 있는 환자(Marginal Patients)’들에게 적용되는 효과임을 이해해야 한다. 이러한 이론적 정교함은 치의학, 공중보건, 역학 분야에서 복잡한 중재 효과를 해석하는 데 필수적인 틀이 되고 있다.4\n\n\n\n2020년 이후 전 세계를 강타한 COVID-19 팬데믹은 역설적으로 의학 및 공중보건 연구에 전례 없는 자연 실험의 기회를 제공했다. 국가별로 상이한 봉쇄 정책, 백신 도입 시기, 마스크 착용 의무화 등은 연구자가 통제할 수 없는 외부 충격(External Shocks)으로서, RCT가 불가능한 비약물적 중재(NPI)의 효과를 평가하는 데 노벨상 수상자들의 방법론이 대거 적용되는 계기가 되었다.11 이 과정에서 관찰 데이터의 ’양’보다 ’설계’의 중요성이 다시금 부각되었으며, 데이터 생성 과정(Data Generating Process)에 대한 이해 없이는 빅데이터도 무용지물임이 증명되었다."
  },
  {
    "objectID": "의학 인과추론 보고서 작성 가이드.html#section-1",
    "href": "의학 인과추론 보고서 작성 가이드.html#section-1",
    "title": "의학 연구의 새로운 패러다임: 인과추론의 혁명과 리얼월드 근거(RWE)의 진화",
    "section": "",
    "text": "2. 인과추론의 정의와 전통적 기법의 한계\n\n\n인과추론의 핵심은 “만약 ~하지 않았더라면(What if)”이라는 반사실적 질문에 답하는 것이다. 예르지 네이만(Jerzy Neyman)과 도널드 루빈(Donald Rubin)이 정립한 잠재적 결과 프레임워크(Potential Outcomes Framework)에 따르면, 각 개인은 치료를 받았을 때의 잠재적 결과(\\(Y^{a=1}\\))와 받지 않았을 때의 잠재적 결과(\\(Y^{a=0}\\))를 동시에 가진다.13\n인과 효과는 이 두 잠재적 결과의 차이(\\(Y^{a=1} \\- Y^{a=0}\\))로 정의된다. 그러나 현실 세계에서는 한 개인에 대해 오직 하나의 결과(사실)만 관찰할 수 있고, 다른 하나(반사실)는 영원히 결측(Missing)된다. 이를 **‘인과추론의 근본적인 문제(Fundamental Problem of Causal Inference)’**라고 한다.13 따라서 인과추론은 개별 수준이 아닌 집단 수준에서, 치료군과 대조군이 서로 ’교환 가능(Exchangeable)’하다는 가정 하에 평균 치료 효과(Average Treatment Effect, ATE)를 추정하는 통계적 과정이다.\n\n\n\nRCT는 무작위 배정을 통해 치료군과 대조군의 기저 특성(관찰된 변수 및 관찰되지 않은 변수 모두)을 통계적으로 균등하게 만듦으로써 ’교환 가능성’을 보장한다. 이로 인해 연관성(Association)이 곧 인과성(Causation)으로 성립된다.\n반면, 관찰 연구에서는 치료가 임의로 배정되지 않고 환자의 상태나 의사의 판단에 따라 결정되므로, 선택 편향(Selection Bias)과 혼란(Confounding)이 필연적으로 발생한다. 이를 극복하기 위해 전통적으로 다음과 같은 기법들이 사용되었다.\n\n성향점수 매칭 (Propensity Score Matching, PSM): 환자가 치료를 받을 확률(성향점수)을 추정하여, 점수가 유사한 환자끼리 짝을 짓는 방법이다. 이는 관찰 데이터를 마치 무작위 실험 데이터처럼 보이게 만드는(Pseudo-randomization) 효과가 있다.1\n\n다변량 회귀분석 (Multivariable Regression): 결과에 영향을 미칠 수 있는 여러 교란 요인들을 모델에 포함하여 통계적으로 보정한다.\n\n\n\n\n전통적 역학 연구에서 흔히 범하는 가장 심각한 오류 중 하나는 ’표 2의 오류’이다. 연구 논문의 두 번째 표(Table 2)에 주로 실리는 다변량 회귀분석 결과에서, 주 노출 변수뿐만 아니라 보정을 위해 포함된 다른 공변량(Covariates)들의 계수(Coefficients)까지 모두 ’서로 통제된 인과적 효과’로 해석하는 것을 말한다.16\n웨스트라이히(Westreich)와 그린란드(Greenland)가 지적한 바와 같이, 하나의 통계 모델은 특정 노출 변수(A)와 결과(Y) 사이의 인과효과를 추정하기 위해 설계된 것이다. 이때 포함된 공변량(Z)은 A의 혼란변수일 수 있지만, Z 자체의 인과효과를 추정하기에는 Z에 대한 혼란변수가 누락되었거나, Z가 매개변수 혹은 충돌변수(Collider)로 작용하여 편향을 유발할 수 있다.14\n즉, “모든 변수를 한꺼번에 넣고 돌린(Mutually adjusted)” 모델의 결과를 모두 인과적으로 해석하는 것은 수학적으로나 논리적으로 불가능하다. 각 변수의 인과효과를 알고 싶다면, 각 변수마다 고유한 인과 다이어그램(DAG)에 기반한 별도의 모델을 구축해야 한다.16 이 오류는 단순한 통계적 실수가 아니라, 데이터 생성 메커니즘에 대한 이해 부족에서 기인하는 구조적 문제다.\n\n\n\n전통적 관찰 연구, 특히 단순한 PSM이나 코호트 연구는 시간의 흐름을 잘못 다루어 심각한 편향을 초래하곤 한다.\n\n불멸의 시간 편향: 연구 시작 시점(Time Zero)과 치료 시작 시점 사이의 괴리에서 발생한다. 예를 들어, “스타틴 복용군”으로 분류되기 위해서는 처방을 받을 때까지 생존해 있어야 한다. 이 대기 기간 동안의 생존은 치료의 효과가 아님에도 불구하고 치료군의 생존 시간에 포함되어, 치료제의 효과를 과대평가하게 만든다.18\n\n우발적 사용자 편향(Prevalent User Bias): 이미 약물을 복용하고 있는 환자(Prevalent user)를 연구에 포함시킬 때 발생한다. 약물의 초기 부작용을 겪고 살아남은(적응한) 환자들만 선택되거나, 장기 복용으로 인해 기저 상태가 변한 환자들이 포함되어 인과적 추론을 왜곡한다.20\n\n이러한 전통적 기법의 한계는 단순한 통계적 보정만으로는 해결할 수 없으며, 연구 설계 자체의 근본적인 혁신을 요구하게 되었다."
  },
  {
    "objectID": "의학 인과추론 보고서 작성 가이드.html#section-2",
    "href": "의학 인과추론 보고서 작성 가이드.html#section-2",
    "title": "의학 연구의 새로운 패러다임: 인과추론의 혁명과 리얼월드 근거(RWE)의 진화",
    "section": "",
    "text": "3. 전통적 한계의 극복: 표적 시행 에뮬레이션(Target Trial Emulation)\n\n\n표적 시행 에뮬레이션(Target Trial Emulation, TTE)은 하버드 대학의 미구엘 허난(Miguel Hernán)과 제임스 로빈스(James Robins)가 주창한 프레임워크로, 관찰 연구의 패러다임을 ’데이터 분석’에서 ’실험 설계’로 전환시켰다. TTE의 핵심 철학은 **“분석하려는 관찰 데이터로 수행하고 싶었던 가상의 이상적인 RCT(Target Trial)를 먼저 설계하고, 이를 관찰 데이터로 최대한 모사(Emulate)한다”**는 것이다.15\n이는 단순히 성향점수 매칭과 같은 통계 기법을 사용하는 것을 넘어, 연구의 질문(Causal Question)을 명확히 하고 설계 단계에서부터 바이어스를 구조적으로 차단하는 체계적인 접근법이다.\n\n\n\nTTE는 이상적인 RCT 프로토콜의 7가지 핵심 요소를 정의하고, 이를 관찰 데이터에 매핑하는 과정을 거친다.15\n\n\n\n\n\n\n\n\n표적 시행(Target Trial) 요소\n관찰 데이터 에뮬레이션(Emulation) 전략\n핵심 고려사항 및 해결 과제\n\n\n\n\n1. 적격성 기준 (Eligibility Criteria)\n데이터베이스 내에서 해당 임상적/인구학적 기준을 만족하는 환자 선별\nTime Zero에 기준을 만족해야 하며, 미래의 정보(예: 생존 여부)를 조건으로 삼으면 안 됨.\n\n\n2. 치료 전략 (Treatment Strategies)\n실제 처방 데이터를 기반으로 비교할 전략 정의 (예: “약물 A 시작” vs “약물 B 시작”)\n‘신규 사용자(Incident User)’ 원칙 준수. 기존 사용자는 배제하여 우발적 사용자 편향 방지.\n\n\n3. 배정 절차 (Assignment Procedures)\n무작위 배정은 불가능하므로, 교환 가능성(Exchangeability) 가정을 만족하도록 통계적 보정 수행\n성향점수(PS)나 역확률 가중치(IPW)를 사용하여 기저 특성의 균형을 맞춤.\n\n\n4. 추적 관찰 기간 (Follow-up Period)\n0시점(Time Zero)부터 결과 발생, 중도 탈락, 또는 연구 종료까지 추적\n치료군과 대조군의 Time Zero를 동기화하여 불멸의 시간 편향 차단.\n\n\n5. 결과 (Outcome)\n프로토콜에 정의된 명확한 임상적 결과 정의\n측정 오차(Measurement Error) 및 정보 편향 주의.\n\n\n6. 인과적 대비 (Causal Contrast)\nITT(치료 의도) 효과 또는 Per-Protocol(순응도 고려) 효과 선택\n관찰 연구에서는 실제 처방이 변경될 수 있으므로, 연구 목적에 맞는 효과(Estimand)를 명확히 정의해야 함.\n\n\n7. 분석 계획 (Analysis Plan)\n결과 모델링 및 인과 효과 추정 (예: Cox 모델, g-formula 등)\n선택 편향과 정보 편향을 보정하기 위한 구체적인 통계적 방법론 명시.\n\n\n\n\n\n\nTTE는 전통적 기법이 해결하지 못한 난제들을 설계적으로 해결한다.\n\nTime Zero의 동기화와 불멸의 시간 편향 제거:\nTTE는 모든 환자가 적격성 기준을 충족하고 치료 전략이 시작되는 시점을 ’0시점’으로 엄격하게 정의한다. 예를 들어, “진단 후 30일 이내 투여”와 같이 조건을 명시하여, 치료를 받기 위해 기다리는 대기 시간을 치료군의 생존 시간에 포함시키지 않도록 한다. 최근 스타틴과 치매 연구에서, TTE를 적용하여 불멸의 시간 편향을 제거한 결과 스타틴의 예방 효과가 과장되었을 가능성이 확인되었다.19\n\n클로닝(Cloning)과 검열(Censoring):\n“진단 후 3개월 이내에 치료를 시작하는 군”과 같은 동적 치료 전략을 비교할 때, 환자는 3개월이 되기 전까지는 어느 군에 속할지 알 수 없다. TTE는 이 기간 동안 환자의 데이터를 복제(Clone)하여 두 전략 모두에 할당한 뒤, 실제 치료 여부가 결정되는 순간 프로토콜과 일치하지 않는 복제본을 인공적으로 검열(Censoring)하는 기법을 사용한다.19 이는 수학적으로 무결한 비교를 가능하게 한다.\n\n신규 사용자 설계(New User Design):\nRCT와 마찬가지로 연구 시작 시점에 해당 약물을 처음 사용하는 환자만을 포함시킴으로써, 약물에 이미 적응한 환자만 남는 선택 편향을 방지한다.24\n\n\n\n\n2024-2025년 발표된 주요 연구들은 TTE의 위력을 보여준다.\n\nGLP-1과 심혈관 질환: 비만 환자에서 GLP-1 수용체 작용제의 심혈관 및 신장 보호 효과를 분석한 연구는 TTE 설계를 통해 RCT인 SELECT 연구와 매우 유사한 결과를 도출해냈다. 이는 RWE가 잘 설계될 경우 RCT를 대체하거나 보완할 수 있음을 시사한다.24\n\n스타틴과 치매: 과거 관찰 연구들이 스타틴의 치매 예방 효과를 일관되게 보여주지 못한 것은 불멸의 시간 편향 때문이었다. 최신 TTE 연구들은 이러한 편향을 제거하고, 로수바스타틴(Rosuvastatin) 등 특정 스타틴이 실제로 치매 위험을 낮출 가능성을 보다 정교하게 제시하고 있다.26"
  },
  {
    "objectID": "의학 인과추론 보고서 작성 가이드.html#section-3",
    "href": "의학 인과추론 보고서 작성 가이드.html#section-3",
    "title": "의학 연구의 새로운 패러다임: 인과추론의 혁명과 리얼월드 근거(RWE)의 진화",
    "section": "",
    "text": "4. 복잡성의 정복: g-method의 이론과 실제\n\n\n만성 질환(당뇨병, HIV, 암 등) 연구에서는 환자의 상태가 변함에 따라 치료가 변경되고, 그 치료가 다시 환자의 상태에 영향을 미치는 과정이 수년간 반복된다. 이때 CD4 수치나 당화혈색소(HbA1c)와 같은 변수는 **‘혼란변수(Confounder)’**이자 동시에 **‘이전 치료의 결과(Mediator)’**라는 이중적 지위를 갖는다.28\n이러한 상황에서 전통적인 회귀분석(Cox 모델 등)을 사용하여 해당 변수를 보정(Adjust)하면 심각한 문제가 발생한다.\n\n과잉 보정(Over-adjustment): 치료가 매개변수를 통해 결과에 미치는 간접 효과까지 제거해버려, 총 효과(Total Effect)를 과소추정하게 된다.\n\n충돌변수 편향(Collider Bias): 매개변수를 통제함으로써, 치료와 결과 사이에 존재하지 않던 가짜 연관성을 생성해낼 수 있다.16\n\n이를 해결하기 위해 제임스 로빈스는 1986년 g-method군을 개발하였으며, 이는 현대 인과추론의 정점으로 평가받는다.\n\n\n\n\n\nIPW는 각 시점별로 환자가 실제로 받은 치료를 받을 확률(성향점수)을 계산하고, 그 역수를 가중치로 부여한다.\n\n원리: 가중치를 적용하면, 마치 모든 환자가 무작위로 치료를 받은 것과 같은 **가상의 모집단(Pseudo-population)**이 생성된다. 이 가상 집단에서는 혼란변수와 치료 간의 연결고리가 끊어지므로, 매개변수를 직접 보정하지 않고도 인과 효과를 추정할 수 있다.28\n\n적용: 치료 순응도가 시간에 따라 변하는 연구에서 ‘순응했다면(Per-protocol)’ 효과를 추정하는 데 표준적으로 사용된다.\n\n\n\n\ng-formula는 관찰된 데이터를 기반으로, 특정 중재 시나리오 하에서의 결과를 **시뮬레이션(Simulation)**하는 기법이다.\n\n원리: (1) 공변량, 치료, 결과 간의 관계를 모델링한 후, (2) 몬테카를로 시뮬레이션 등을 통해 “만약 모든 환자가 5년간 약물 A를 지속적으로 복용했다면?”과 같은 반사실적 데이터를 생성한다. (3) 이를 “약물 B를 복용했다면?”의 시나리오와 비교한다.28\n\n장점: 단순한 치료 비교를 넘어, “당화혈색소가 7.0% 이상일 때만 인슐린을 시작한다”와 같은 복잡한 **동적 치료 전략(Dynamic Treatment Regimes)**을 비교하는 데 독보적이다.\n\n최신 사례: 2025년 발표된 천식 치료 궤적 연구와 당뇨병 환자의 혈당 변동성 연구는 g-formula를 사용하여 장기간의 치료 경로와 결과를 성공적으로 시뮬레이션하고 인과 효과를 추정했다.32\n\n\n\n\n주로 생존 분석이나 중도 절단(Censoring)이 심한 데이터에서 사용되며, 모델의 가정에 덜 민감하고(Robust) 효과의 이질성(Effect Modification)을 탐지하는 데 유리하다.34\n\n\n\n\n\n\n\n\n\n\n\n\n특징\n전통적 회귀분석 (Cox, Logistic)\ng-method (IPW, g-formula)\n\n\n\n\n교란 요인 처리 방식\n모델에 변수로 포함 (Conditioning)\n가중치 부여(IPW) 또는 시뮬레이션(g-formula)\n\n\n피드백 루프 대응\n불가능. 매개변수이기도 한 교란 요인을 보정 시 편향 발생 (Null Paradox 등).\n가능. 교란 경로를 차단하거나(IPW) 표준화(Standardization)하여 총 효과를 정확히 추정.\n\n\n결과 해석\n조건부 연관성 (Conditional Association)\n인과적 효과 (Marginal Causal Effect)\n\n\n주요 적용 대상\n단일 시점 노출, 고정된 교란 요인\n만성 질환의 장기 추적, 치료 변경이 빈번한 연구"
  },
  {
    "objectID": "의학 인과추론 보고서 작성 가이드.html#section-4",
    "href": "의학 인과추론 보고서 작성 가이드.html#section-4",
    "title": "의학 연구의 새로운 패러다임: 인과추론의 혁명과 리얼월드 근거(RWE)의 진화",
    "section": "",
    "text": "5. 규제 과학과 보고 표준: ’인과적 언어’의 시민권 획득\n\n\n미국 FDA는 21세기 치료법(21st Century Cures Act)에 따라 RWE를 규제 의사결정에 활용하기 위한 노력을 지속해 왔으며, 2023년 초안을 거쳐 2024-2025년에 걸쳐 **비중재적 연구(Non-interventional Studies)**에 대한 가이드라인을 확정 짓고 있다.6 FDA의 입장은 “RWE는 더 이상 단순한 보조 자료가 아니다”라는 것으로 요약된다.\n\n적합성(Fitness for Use): FDA는 데이터가 신뢰성(Reliability)(정확성, 완전성, 추적 가능성)과 관련성(Relevance)(주요 변수 포함 여부, 대표성)을 갖춰야 함을 명시했다. 특히 EHR이나 청구 데이터의 품질을 평가하는 구체적인 기준을 제시하고 있다.6\n\n사전 설계(Prespecification) 의무화: 관찰 연구의 고질적 문제인 ’데이터 마이닝(Data Dredging)’과 ’P-hacking’을 방지하기 위해, 연구 수행 전(데이터를 열어보기 전)에 프로토콜과 분석 계획을 확정하고 FDA와 협의할 것을 강력히 권고한다. 이때 TTE 프레임워크의 사용이 사실상 표준으로 자리 잡고 있다.6\n\n인과추론의 수용: 적절한 설계(TTE 등)와 분석(g-method 등)이 뒷받침된다면, 비중재적 연구로도 약물의 유효성과 안전성에 대한 인과적 결론을 내릴 수 있음을 인정하는 추세다.\n\n\n\n\n2025년 9월, JAMA와 BMJ, PLOS Medicine 등 주요 저널에 동시에 게재된 **TARGET 성명서(Transparent Reporting of Observational Studies Emulating a Target Trial)**는 RWE 연구 보고의 투명성을 획기적으로 높이기 위한 국제적 합의다.36\nTARGET은 기존의 STROBE 가이드라인이 해결하지 못한 ’인과추론 연구의 특수성’을 반영한다. 21개 항목으로 구성된 체크리스트는 연구자에게 다음을 요구한다.\n\n연구가 에뮬레이션하고자 하는 가상의 표적 시행 프로토콜을 명시적으로 기술할 것.\n\n실제 관찰 데이터가 이 프로토콜의 각 요소(적격성, 치료, 추적 관찰 등)와 어떻게 **매핑(Mapping)**되는지를 상세히 보고할 것.\n\n잔존하는 교란 요인(Residual Confounding)과 에뮬레이션 실패 가능성을 투명하게 논의할 것.\n\n이는 독자와 리뷰어가 연구의 설계상 오류(예: 불멸의 시간 편향)를 쉽게 식별할 수 있게 하며, 관찰 연구가 RCT에 준하는 엄격함을 갖추도록 강제하는 효과가 있다.37\n\n\n\n과거 의학 저널, 특히 NEJM이나 JAMA는 관찰 연구에서 ‘영향을 미친다(Effect)’, ’감소시킨다(Reduce)’와 같은 인과적 단어 사용을 엄격히 금지하고, ’관련이 있다(Associated with)’라는 표현만을 허용했다. 이는 관찰 연구의 내재적 편향에 대한 방어기제였다.\n그러나 최근 TTE와 같은 엄격한 방법론이 적용된 연구에 대해서는 이러한 제한이 완화되고 있다. 연구자들은 이제 설계가 견고하다면 “A가 B의 위험을 낮추는 것으로 추정된다”와 같은 인과적 표현을 사용할 수 있다.5\n하지만 동시에 **‘인과적 언어 비약(Causal Language Jump)’**에 대한 경계심도 높아지고 있다. 이는 연구 본문에서는 조심스럽게 상관관계로 기술하고 결론이나 가이드라인에서는 강력한 인과관계로 둔갑시키는 현상을 말한다. 최근 연구들은 가이드라인의 권고안이 원본 연구의 근거 수준보다 더 강한 인과적 주장을 하는 경향이 있음을 지적하며, 근거와 주장 사이의 일치성을 강조하고 있다.5"
  },
  {
    "objectID": "의학 인과추론 보고서 작성 가이드.html#section-5",
    "href": "의학 인과추론 보고서 작성 가이드.html#section-5",
    "title": "의학 연구의 새로운 패러다임: 인과추론의 혁명과 리얼월드 근거(RWE)의 진화",
    "section": "",
    "text": "6. 최신 RWE 사례 분석: 이론의 실전 적용 (2024-2025)\n\n\n2024년 발표된 세마글루타이드(GLP-1 제제)가 제2형 당뇨병 환자의 알츠하이머병(AD) 위험을 감소시키는지를 분석한 RWE 연구는 TTE 적용의 명과 암을 보여주는 대표적 사례다.23\n\n연구 설계: 연구팀은 TTE 프레임워크를 적용하여, 세마글루타이드 신규 사용자(Initiators)와 다른 당뇨병 약물(인슐린, 메트포르민 등) 신규 사용자를 비교했다. 3년의 추적 관찰 기간 동안 세마글루타이드 사용군에서 AD 발병 위험이 유의하게 낮음을 보고했다.\n\n성과: RCT가 아직 완료되지 않은 상황에서 시의적절한 근거를 제공했으며, TTE를 통해 불멸의 시간 편향 등을 제어하려는 노력이 돋보였다.\n\n논쟁과 교훈: 그러나 비평가들은 대조군 설정의 문제점을 지적했다. 인슐린 사용자는 일반적으로 당뇨병 진행이 더 많이 된 환자군이므로, 기저 질환의 중증도가 세마글루타이드군보다 높을 수밖에 없다(Confounding by indication). 성향점수 매칭을 했더라도 측정되지 않은 중증도 차이가 잔존할 수 있다는 것이다.41 이는 TTE가 설계적 오류(Design flaw)는 해결해 주지만, 데이터 자체의 한계(Data limitation)나 임상적 맥락을 무시한 비교까지 해결해 주지는 못함을 시사한다.\n\n\n\n\n캐나다 브리티시컬럼비아주에서 시행된 바이오시밀러 강제 전환 정책을 평가한 연구는 노벨상 수상 방법론인 RDD를 의학 정책 평가에 적용한 모범 사례다.9\n\n방법론: 정책 시행일(Cutoff)을 기준으로, 그 직전에 약물을 시작한 환자와 직후에 시작한 환자를 비교했다. 이들은 시간적으로 매우 인접해 있어 임상적 특성이 거의 동일하므로(Locally Randomized), 정책 시행 전후의 결과 차이를 정책의 인과적 효과로 해석할 수 있다.\n\n결과: 연구 결과, 정책 시행이나 바이오시밀러 사용이 환자의 입원율이나 응급실 방문 증가와 인과적인 관련이 없음을 밝혀냈다. 이는 RCT 없이도 정책의 안전성을 입증한 강력한 RWE 사례로 꼽힌다."
  },
  {
    "objectID": "의학 인과추론 보고서 작성 가이드.html#section-6",
    "href": "의학 인과추론 보고서 작성 가이드.html#section-6",
    "title": "의학 연구의 새로운 패러다임: 인과추론의 혁명과 리얼월드 근거(RWE)의 진화",
    "section": "",
    "text": "결론 및 제언\n2021년 노벨 경제학상이 촉발한 인과추론의 혁명은 의학 연구의 지형을 근본적으로 변화시켰다. ‘연관성’의 시대는 저물고, 이제 의학 연구자들은 관찰 데이터로부터 **’인과성’**을 추출해내기 위한 정교한 공학적 접근을 요구받고 있다. 표적 시행 에뮬레이션(TTE)은 단순한 분석 도구가 아니라 연구를 바라보는 세계관(Mindset)의 전환이며, g-method는 복잡한 현실 세계의 치료 과정을 수학적으로 풀어내는 열쇠다.\nTARGET 성명서의 발표와 FDA 가이드라인의 고도화는 이러한 방법론들이 더 이상 학문적 유희가 아니라, 환자의 생명과 직결된 의사결정의 표준이 되었음을 의미한다. 그러나 세마글루타이드 연구의 논쟁에서 보듯이, 아무리 훌륭한 방법론도 임상적 맥락에 대한 깊은 이해와 고품질의 데이터 없이는 사상누각에 불과하다.\n앞으로의 의학 연구는 **“어떻게 하면 관찰 데이터를 무작위 실험처럼 다룰 수 있을 것인가?”**라는 질문에 답하기 위해, 데이터 과학, 역학, 그리고 임상의학이 융합된 고도의 인과추론 설계를 지향해야 할 것이다. 이것이 바로 리얼월드 데이터가 진정한 리얼월드 근거로 거듭나는 길이다.\n– 부록 내가 할거\nConfounder와 collider 어떻게 선택할것인가? 이거랑\n막판에 머신러닝 관련된 부분 넣기 interaction이런게 생각보다 중요한 변수이니까\n\n\n\nEmulating Clinical Trials with the Mayo Clinic Platform: Cardiovascular Research Perspective - medRxiv, 1월 2, 2026에 액세스, https://www.medrxiv.org/content/10.1101/2025.03.19.25324271v1.full.pdf\n\nConducting observational analyses with the target trial emulation approach: a methodological systematic review | BMJ Open, 1월 2, 2026에 액세스, https://bmjopen.bmj.com/content/bmjopen/14/11/e086595.full.pdf\n\nCausal Inference: Onward and Upward! - PubMed, 1월 2, 2026에 액세스, https://pubmed.ncbi.nlm.nih.gov/35311410/\n\nCausal Inference: Onward and Upward! - PMC, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC9260467/\n\nCausal language jumps in clinical practice guidelines for diabetes management - arXiv, 1월 2, 2026에 액세스, https://arxiv.org/html/2503.03557v1\n\nReal-World Evidence: Considerations Regarding Non … - FDA, 1월 2, 2026에 액세스, https://www.fda.gov/media/177128/download\n\nMendelian Randomization Methods for Causal Inference: Estimands, Identification and Inference - arXiv, 1월 2, 2026에 액세스, https://arxiv.org/pdf/2509.11519\n\nMultiple discoveries in causal inference: LATE for the party - PMC - NIH, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC11218811/\n\nThe impact of biosimilar use on healthcare utilization among new …, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC12017995/\n\nFull article: Empowering leadership in crisis: a natural experiment - Taylor & Francis, 1월 2, 2026에 액세스, https://www.tandfonline.com/doi/full/10.1080/14719037.2025.2459162\n\nNatural experiments: A Nobel Prize awarded research design for strengthening causal inference on global health challenges, 1월 2, 2026에 액세스, https://jogh.org/wp-content/uploads/2022/04/jogh-12-03005.pdf\n\n(PDF) Natural experiments: A Nobel Prize awarded research design for strengthening causal inference on global health challenges - ResearchGate, 1월 2, 2026에 액세스, https://www.researchgate.net/publication/360243525_Natural_experiments_A_Nobel_Prize_awarded_research_design_for_strengthening_causal_inference_on_global_health_challenges\n\nHow to select predictive models for decision-making or causal inference - Oxford Academic, 1월 2, 2026에 액세스, https://academic.oup.com/gigascience/article/doi/10.1093/gigascience/giaf016/8089999\n\nConcepts (R) – Advanced Epidemiological Methods, 1월 2, 2026에 액세스, https://ehsanx.github.io/EpiMethods/confounding0.html\n\nTarget Trial Emulation: A Framework for Causal RWE | IntuitionLabs, 1월 2, 2026에 액세스, https://intuitionlabs.ai/articles/target-trial-emulation-rwe\n\nUsing causal diagrams and multiple comparison … - medRxiv, 1월 2, 2026에 액세스, http://medrxiv.org/cgi/reprint/2024.02.26.24303405v1\n\nRevisiting the Table 2 Fallacy: A Motivating Example Examining Preeclampsia and Preterm Birth - PubMed Central, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC6103824/\n\nOpportunities, challenges and future perspectives for target trial emulation in critical care clinical research - NIH, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC12613904/\n\nTarget trial emulation framework: mitigating methodological challenges and application in COVID-19 treatment evaluation studies | Request PDF - ResearchGate, 1월 2, 2026에 액세스, https://www.researchgate.net/publication/391299562_Target_trial_emulation_framework_mitigating_methodological_challenges_and_application_in_COVID-19_treatment_evaluation_studies\n\nTarget Trial Emulation: A Primer on Improving Observational Research in Neurology, 1월 2, 2026에 액세스, https://www.neurology.org/doi/10.1212/WNL.0000000000214269\n\nThe target trial framework for causal inference from observational data: Why and when is it helpful? - PMC - NIH, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC11936718/\n\nExternal comparator studies and the joint application of the estimand and target trial emulation frameworks - Frontiers, 1월 2, 2026에 액세스, https://www.frontiersin.org/journals/drug-safety-and-regulation/articles/10.3389/fdsfr.2024.1409102/full\n\nTarget trial emulation to reduce confounding in therapy effectiveness assessment - (Based on the Cohort Study by Wang et al. on Semaglutide and Opioid Overdose Risk in Patients With Type 2 Diabetes and Opioid Use Disorder) | Sciety, 1월 2, 2026에 액세스, https://sciety.org/articles/activity/10.31219/osf.io/mwthq_v1\n\nCardiovascular and kidney outcomes of GLP-1 receptor agonists in adults with obesity: A target trial emulation study - PubMed, 1월 2, 2026에 액세스, https://pubmed.ncbi.nlm.nih.gov/40874398/\n\n1A-03 - Primary Prevention of Cardiovascular and Renal Outcomes with GLP-1 Receptor Agonists in Adults with Obesity: A Target Trial Emulation Study - 2025 ISPE Annual Meeting, 1월 2, 2026에 액세스, https://2025ispe.eventscribe.net/ajaxcalls/PresentationInfo.asp?PresentationID=1653403\n\nAssociation of Different Statins with Incident ADRD: A Target Trial Emulation Study, 1월 2, 2026에 액세스, https://www.researchgate.net/publication/399090145_Association_of_Different_Statins_with_Incident_ADRD_A_Target_Trial_Emulation_Study\n\nStatin Initiation and Dementia Incidence in a Large Health Care System From 1997 to 2020: A Target Trial Emulation Study - PubMed Central, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC12205742/\n\nTime-Varying Confounding: A Summary of Key Ideas and Frequently …, 1월 2, 2026에 액세스, https://evidenceforaction.org/time-varying-confounding-summary-key-ideas-and-frequently-asked-questions\n\nG-methods in the existence of time varying confounding, 1월 2, 2026에 액세스, https://zhjbkz.ahmu.edu.cn/en/article/doi/10.16462/j.cnki.zhjbkz.2021.06.002\n\nTime-Varying Confounding - Evidence for Action, 1월 2, 2026에 액세스, https://evidenceforaction.org/sites/default/files/2021-05/E4A-TVC-Methods-Note.pdf\n\nThe Parametric g-Formula for Time-to-event Data - CDC Stacks, 1월 2, 2026에 액세스, https://stacks.cdc.gov/view/cdc/201397/cdc_201397_DS1.pdf\n\nModelling Asthma Treatment Dynamics: Insights from the g-Formula - PMC - NIH, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC11913031/\n\nLong-term glycemic variability and the risk of cardiovascular diseases in type 2 diabetic patients: Effect of hypothetical interventions using parametric g-formula in a population-based historical cohort study | PLOS One, 1월 2, 2026에 액세스, https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0319975\n\nUsing generalized linear models to implement g-estimation for survival data with time-varying confounding - PubMed Central, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC7612171/\n\nUse of Real-World Evidence To Support Regulatory Decision-Making for Medical Devices; Guidance for Industry and Food and Drug Administration Staff; Availability - Federal Register, 1월 2, 2026에 액세스, https://www.federalregister.gov/documents/2025/12/18/2025-23252/use-of-real-world-evidence-to-support-regulatory-decision-making-for-medical-devices-guidance-for\n\nTARGET 2025 Guidelines Published in JAMA | Harvard T.H. Chan School of Public Health, 1월 2, 2026에 액세스, https://hsph.harvard.edu/causalab/news/target-2025-guidelines-published-in-jama/\n\nTransparent reporting of observational studies emulating a target trial - The BMJ, 1월 2, 2026에 액세스, https://www.bmj.com/content/390/bmj-2025-087179.full.pdf\n\nTransparent Reporting of Observational Studies Emulating a Target Trial-The TARGET Statement - PubMed, 1월 2, 2026에 액세스, https://pubmed.ncbi.nlm.nih.gov/40899949/\n\nFrom emulation to evidence: The concepts, limitations, and prospects of TTE and TARGET, 1월 2, 2026에 액세스, https://www.the-innovation.org/article/doi/10.59717/j.xinn-med.2025.100172\n\nQuality of causality assessment among observational studies in intensive care: A methodological review | Request PDF - ResearchGate, 1월 2, 2026에 액세스, https://www.researchgate.net/publication/395161889_Quality_of_causality_assessment_among_observational_studies_in_intensive_care_A_methodological_review\n\nComment on “Associations of semaglutide with first‐time diagnosis of Alzheimer’s disease in patients with type 2 diabetes: Target trial emulation using nationwide real‐world data in the US” - PMC - PubMed Central, 1월 2, 2026에 액세스, https://pmc.ncbi.nlm.nih.gov/articles/PMC12069008/\n\nASSOCIATIONS OF SEMAGLUTIDE WITH ALZHEIMER’S DISEASE-RELATED DEMENTIAS IN PATIENTS WITH TYPE 2 DIABETES: A REAL-WORLD TARGET TRIAL EMULATION STUDY - Chiro.org, 1월 2, 2026에 액세스, https://chiro.org/Graphics_Box_NUTRITION/ABSTRACTS/Associations_of_Semaglutide_With_Alzheimers.shtml"
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#시나리오-심장판막-질환의-딜레마",
    "href": "posts/2026-01-02-propensity-score/index.html#시나리오-심장판막-질환의-딜레마",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "1. 시나리오: 심장판막 질환의 딜레마",
    "text": "1. 시나리오: 심장판막 질환의 딜레마\n당신은 심장내과 전문의다. 심장판막 질환 환자에게는 두 가지 선택지가 있다.\n\n\n수술 (Surgery, \\(T=1\\)): 가슴을 여는 개흉 수술. 효과는 확실하지만 체력적 부담이 크다. 주로 젊고 건강한(50~60대) 환자들이 선택한다.\n\n시술 (Procedure, \\(T=0\\)): 카테터를 이용한 비침습적 시술(예: TAVI). 수술을 견디기 힘든 고령(70~80대)이나 고위험군 환자들이 주로 선택한다.\n\n데이터를 열어보니 시술군(\\(T=0\\))의 사망률이 압도적으로 높다. 이것은 수술이 시술보다 탁월해서일까? 아니면 단순히 시술받은 사람들이 더 늙고 아파서일까? (Selection Bias).\n우리의 목표는 ’나이(Age)’라는 교란변수를 통제하고, “수술이 시술보다 정말로 사망률을 낮추는가?”에 답하는 것이다."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#r-simulation-가상-데이터-생성",
    "href": "posts/2026-01-02-propensity-score/index.html#r-simulation-가상-데이터-생성",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "2. R Simulation: 가상 데이터 생성",
    "text": "2. R Simulation: 가상 데이터 생성\n현실을 모사한 데이터를 만들어보자. * 진실(Ground Truth): 수술(\\(T=1\\))은 시술(\\(T=0\\))에 비해 사망 위험을 낮춘다. (True Effect 존재) * 상황: 나이가 많을수록 수술보다는 시술을 받으려 한다. 나이가 많을수록 사망 위험은 커진다.\n\nlibrary(tidyverse)\nlibrary(MatchIt)  # PSM\nlibrary(WeightIt) # IPTW, OW\nlibrary(cobalt)   # Covariate Balance Plot\nlibrary(sandwich) # Robust SE\nlibrary(lmtest)   # Coeftest\n\nset.seed(2026)\nn &lt;- 3000\n\n# 1. 교란변수 생성: 나이 (Age)\n# 전체 평균 65세, 표준편차 10\nage &lt;- rnorm(n, mean = 65, sd = 10)\n\n# 2. 치료 배정 (Treatment Assignment)\n# 나이가 젊을수록(-age) 수술(T=1) 받을 확률이 높음\n# 나이가 50세면 수술 확률 &gt; 90%, 80세면 수술 확률 &lt; 10%\nps_true &lt;- plogis(10 - 0.15 * age) \ntreat &lt;- rbinom(n, 1, ps_true)\n\n# 3. 결과 생성 (Outcome: 1년 내 사망 여부)\n# 기본 사망률은 나이에 비례 (+0.1*age)\n# 수술(treat=1)을 받으면 사망 위험 감소 (-1.5)\n# 노이즈 추가\nmortality_prob &lt;- plogis(-8 + 0.1 * age - 1.0 * treat)\nmortality &lt;- rbinom(n, 1, mortality_prob)\n\ndf &lt;- tibble(age, treat, mortality)\n\n# 데이터 확인\ndf %&gt;% \n  group_by(treat) %&gt;% \n  summarise(\n    n = n(),\n    mean_age = mean(age),\n    mortality_rate = mean(mortality)\n  )\n\n# A tibble: 2 × 4\n  treat     n mean_age mortality_rate\n  &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;\n1     0  1349     70.5         0.305 \n2     1  1651     60.3         0.0660\n\n\n[예상되는 데이터 현황] * 수술군(1): 평균 나이 약 55~60세, 사망률 낮음. * 시술군(0): 평균 나이 약 70~75세, 사망률 높음. * 단순 비교(Naive) 시 수술이 엄청나게 좋아 보일 것임 (교란 효과)."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#naive-analysis-보정하지-않은-결과",
    "href": "posts/2026-01-02-propensity-score/index.html#naive-analysis-보정하지-않은-결과",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "3. Naive Analysis: 보정하지 않은 결과",
    "text": "3. Naive Analysis: 보정하지 않은 결과\n먼저 아무런 보정 없이 단순 회귀분석을 돌려보자.\n\n# 단순 비교\nfit_naive &lt;- glm(mortality ~ treat, data = df, family = binomial)\nexp(coef(fit_naive))[\"treat\"]\n\n    treat \n0.1613255 \n\n\n아마 오즈비(OR)가 0.2~0.3 수준으로 나올 것이다. “수술하면 사망 위험이 70% 감소한다!”라고 주장한다면 이는 나이 차이를 무시한 엉터리 주장이다."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#method-1-psm-target-att",
    "href": "posts/2026-01-02-propensity-score/index.html#method-1-psm-target-att",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "4. Method 1: PSM (Target: ATT)",
    "text": "4. Method 1: PSM (Target: ATT)\n첫 번째 방법은 성향점수 매칭(PSM)이다. 가장 직관적이고 널리 쓰이는 방법이다. 우리는 “실제로 수술을 받은 환자들(Treated)”에게 관심이 있다.\n\n질문 (ATT, Average Treatment Effect on the Treated): “이미 수술대에 누운 이 환자들(주로 50~60대)이, 만약 시술을 받았다면 어땠을까?”\n\n수술군(50대)과 비슷한 나이의 시술군(50대인데 드물게 시술받은 사람)을 찾아 짝을 짓는다.\n\n# PS 추정 및 매칭\nm_out &lt;- matchit(treat ~ age, data = df, method = \"nearest\", ratio = 1)\n\nWarning: Fewer control units than treated units; not all treated units will get\na match.\n\nmatched_data &lt;- match.data(m_out)\n\n# 밸런스 확인 (Love Plot)\nlove.plot(m_out, binary = \"std\", thresholds = c(m = .1))\n\n\n\n\n\n\n\n\n\n해석: 매칭 후 두 그룹의 나이 차이가 거의 0이 되었다.\n\n주의점: 수술군과 짝이 될 시술군이 부족한 70~80대 초고령 수술 환자나, 짝을 찾지 못한 초고령 시술 환자는 분석에서 버려진다(Discarded).\n\n결과 추정 (ATT):\n\n\nfit_psm &lt;- glm(mortality ~ treat + age, data = matched_data, family = binomial)\nexp(coef(fit_psm))[\"treat\"]\n\n   treat \n0.419416 \n\n\n이 값은 “수술을 선택한 집단”에서의 수술 효과다."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#method-2-iptw-target-ate",
    "href": "posts/2026-01-02-propensity-score/index.html#method-2-iptw-target-ate",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "3. Method 2: IPTW (Target: ATE)",
    "text": "3. Method 2: IPTW (Target: ATE)\n이번엔 질문을 바꿔보자. “만약 심장 판막 질환을 진단 받은 전 인구에 대해 수술을 권장한다면?”\n\nw_ate &lt;- weightit(treat ~ age, data = dt, method = \"glm\", estimand = \"ATE\")\nsummary(w_ate$weights)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.043   1.458   1.753   2.000   2.247  18.902 \n\n# (1) 리스크 스케일: 가중 사망률 차이 (ATE)\nestimate_risk(dt, w = w_ate$weights)\n\n# A tibble: 1 × 4\n  p_treat p_control      RD    RR\n    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;\n1   0.119     0.118 0.00114  1.01\n\ndt[, .(w_mean_age = weighted.mean(age, w_ate$weights)), by = treat]\n\n   treat w_mean_age\n   &lt;int&gt;      &lt;num&gt;\n1:     0   65.02374\n2:     1   65.00779\n\n# (2) 참고: OR로 요약 (robust SE)\nfit_iptw &lt;- glm(mortality ~ treat+age, data = dt, weights = w_ate$weights, family = binomial())\nglmshow.display(fit_iptw)\n\n$first.line\n[1] \"Logistic regression predicting mortality\\n\"\n\n$table\n      crude OR.(95%CI)   crude P value adj. OR.(95%CI)    adj. P value\ntreat \"1.01 (0.97,1.05)\" \"0.578\"       \"1.02 (0.98,1.06)\" \"0.407\"     \nage   \"1.09 (1.09,1.09)\" \"&lt; 0.001\"     \"1.09 (1.09,1.09)\" \"&lt; 0.001\"   \n\n$last.lines\n[1] \"No. of observations = 50000\\nAIC value = 57385.922\\n\\n\"\n\nattr(,\"class\")\n[1] \"display\" \"list\"   \n\n\nIPTW로 weight를 적용한한 데이터에 대해서 살펴보자. 지금 데이터를 보면 알 수 있듯이 처음에 가정한것 처럼 평균 65세의 심장판막 진단 환자군이라는 것을 알 수 있다. 즉, IPTW는 전체 인구(고령 포함)를 타겟으로 하므로, 결과는 ATE 관점이다. 여기서 확인할 수 있는 결과는 심장판막 질환을 진단받은 모든 사람을 대상으로 수술과 시술의 효과를 비교했을 때는 OR이 1 그리고 p-value가 0.578로 두 시술의 효과가 크게 차이가 없다는 것을 알 수 있다.\n\n1살(age) 단위 strata에서의 OR (전체 인구)\n표본이 충분하다면 age를 1살 단위로 나눠서, 각 strata에서 OR(Surgery vs Procedure)를 구한 뒤 점을 선으로 이어 보는 방식이 가장 직관적이다.\n\nor_by_age1 &lt;- dt %&gt;%\n  as_tibble() %&gt;%\n  mutate(age1 = floor(age)) %&gt;%\n  group_by(age1) %&gt;%\n  group_modify(function(.x, .y) {\n    tab &lt;- table(.x$mortality, .x$treat)\n    if (nrow(tab) &lt; 2 || ncol(tab) &lt; 2 || any(tab &lt; 3)) {\n      return(tibble(or = NA_real_, lo = NA_real_, hi = NA_real_))\n    }\n\n    fit &lt;- glm(mortality ~ treat, data = .x, family = binomial())\n    co &lt;- summary(fit)$coef\n    est &lt;- co[\"treat\", \"Estimate\"]\n    se &lt;- co[\"treat\", \"Std. Error\"]\n\n    tibble(or = exp(est), lo = exp(est - 1.96 * se), hi = exp(est + 1.96 * se))\n  }) %&gt;%\n  ungroup() %&gt;%\n  filter(!is.na(or))\n\nggplot(or_by_age1, aes(x = age1, y = or)) +\n  geom_ribbon(aes(ymin = lo, ymax = hi), alpha = 0.12) +\n  geom_point(size = 0.9, alpha = 0.8) +\n  geom_line(linewidth = 0.7) +\n  geom_hline(yintercept = 1, linetype = 2) +\n  scale_y_log10() +\n  coord_cartesian(ylim = c(0.2, 5)) +\n  labs(x = \"Age (years)\", y = \"OR (Surgery vs Procedure)\")"
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#method-3-overlap-weighting-target-ato",
    "href": "posts/2026-01-02-propensity-score/index.html#method-3-overlap-weighting-target-ato",
    "title": "Causal Inference (2)",
    "section": "6. Method 3: Overlap Weighting (Target: ATO)",
    "text": "6. Method 3: Overlap Weighting (Target: ATO)\n세 번째 방법은 Overlap Weighting (OW)이다.\n\n질문 (ATO): “수술을 해도 되고 시술을 해도 되는, 임상적으로 애매한(Equipose) 환자들(주로 60대)에게는 무엇이 최선인가?”\n\n무조건 수술해야 하는 50대나, 무조건 시술해야 하는 80대는 가중치를 낮춘다. 대신 두 치료법의 선택 확률이 반반에 가까운 60대 환자들에게 집중한다.\n\n# ATO 가중치 생성\nw_ow &lt;- weightit(treat ~ age, data = df, method = \"ps\", estimand = \"ATO\")\n\n# 가중치 분포 확인 - 매우 안정적\nsummary(w_ow$weights)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n0.003984 0.171681 0.326020 0.359861 0.520912 0.989051 \n\n# 밸런스 확인 - ATO가 밸런스를 제일 잘 맞춤 (Exact Balance)\nlove.plot(w_ow, binary = \"std\", thresholds = c(m = .1))\n\n\n\n\n\n\n# 결과 추정 (ATO)\nfit_ow &lt;- glm(mortality ~ treat, data = df, weights = w_ow$weights, family = binomial)\n\nWarning in eval(family$initialize): non-integer #successes in a binomial glm!\n\ncoeftest(fit_ow, vcov = vcovHC(fit_ow, type = \"HC1\"))\n\n\nz test of coefficients:\n\n             Estimate Std. Error z value  Pr(&gt;|z|)    \n(Intercept) -1.318818   0.069893 -18.869 &lt; 2.2e-16 ***\ntreat       -0.912332   0.129981  -7.019 2.235e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nexp(coef(fit_ow))[\"treat\"]\n\n    treat \n0.4015865"
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#종합-비교-어떤-숫자를-믿어야-할까",
    "href": "posts/2026-01-02-propensity-score/index.html#종합-비교-어떤-숫자를-믿어야-할까",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "7. 종합 비교: 어떤 숫자를 믿어야 할까?",
    "text": "7. 종합 비교: 어떤 숫자를 믿어야 할까?\n\n\n\n\n\n\n\n\n방법론\nEstimand\n해석\n특징\n\n\n\nPSM\nATT\n“수술 받은 환자들(젊은 층)에겐 수술이 이만큼 좋았다.”\n가장 직관적. 데이터 손실 발생.\n\n\nIPTW\nATE\n“모든 환자에게 수술을 시킨다면 이만큼 좋을 것이다.”\n가중치 폭발 위험(불안정). 전체 인구 대표.\n\n\nOW\nATO\n“수술/시술 고민되는 환자들(중년)에겐 수술이 이만큼 좋다.”\n통계적으로 가장 안정적. 대상 집단이 바뀜.\n\n\n\nCATE (Conditional ATE)와 정밀 의료\n결국 “평균적인 효과” 하나만으로는 부족할 때가 많다. * 수술은 젊은 사람(ATT 타겟)에게는 효과적이지만, 80세 노인(ATE에 포함됨)에게는 오히려 해로울 수도 있다. * 이처럼 환자의 특성(\\(X\\))에 따라 치료 효과가 달라지는 것을 이질성(Heterogeneity)이라고 하며, 이를 CATE 또는 ITE (Individual Treatment Effect)라고 한다.\n최근의 인과추론 연구는 단순히 ATE/ATT를 구하는 것을 넘어, “누구에게 수술이 이득이고 누구에게 시술이 이득인가?”를 밝혀내는 정밀 의료(Precision Medicine)로 나아가고 있다.\n다음 편에서는 이제 이 분석에 ‘시간(Time)’ 개념을 섞어보자. 만약 수술은 바로 하는데, 시술은 대기 시간이 길다면? 치료 효과가 시간이 지날수록 변한다면? Target Trial Emulation이 필요한 시점이다."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#심화-overlap-weighting-target-ato",
    "href": "posts/2026-01-02-propensity-score/index.html#심화-overlap-weighting-target-ato",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "6. 심화: Overlap Weighting (Target: ATO)",
    "text": "6. 심화: Overlap Weighting (Target: ATO)\nIPTW의 불안정성(Extreme Weight)을 해결하기 위한 대안으로 Overlap Weighting (OW)이 있다. 이는 분산을 최소화하여 통계적 효율성을 극대화하지만, 그 대가로 우리가 알고 싶은 모집단(ATE, ATT)이 아닌 ‘임상적으로 애매한(Equipose) 집단’이라는 새로운 대상을 정의한다. 이를 ATO (Average Treatment Effect in the Overlap population)라고 한다.\n\n# ATO 가중치 생성\nw_ow &lt;- weightit(treat ~ age, data = df, method = \"ps\", estimand = \"ATO\")\n\n# 가중치 분포 확인 - 매우 안정적\nsummary(w_ow$weights)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n0.003984 0.171681 0.326020 0.359861 0.520912 0.989051 \n\n# 결과 추정 (ATO)\nfit_ow &lt;- glm(mortality ~ treat, data = df, weights = w_ow$weights, family = binomial)\n\nWarning in eval(family$initialize): non-integer #successes in a binomial glm!\n\nexp(coef(fit_ow))[\"treat\"]\n\n    treat \n0.4015865 \n\n\n결과는 안정적이지만, “이 결과가 전체 환자에게 적용되는가?”라는 질문에는 “아니오, 수술과 시술 사이에서 고민되는 중간층 환자에게만 해당됩니다”라고 답해야 한다."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#example-procedure-vs-surgery",
    "href": "posts/2026-01-02-propensity-score/index.html#example-procedure-vs-surgery",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "1. Example: Procedure vs Surgery",
    "text": "1. Example: Procedure vs Surgery\n아래의 예시를 살펴보자. 심장판막 질환 환자에게는 두 가지 선택지가 있다고 가정하자(예시를 위한 것이고 실제 임상적 사실과는 차이가 있을 수 있다)\n\n\n수술 (Surgery, \\(T=1\\)): 젊은 환자(50~60대)에게는 완치에 가깝지만, 80대 이상 노인에게는 수술 자체가 사망 위험을 높일 수 있다.\n\n시술 (Procedure, \\(T=0\\)): 비침습적 시술. 고령 환자가 주로 선택한다.\n\n데이터를 열어보니 시술군(\\(T=0\\))의 사망률이 높다. 하지만 이는 시술군이 고령이기 때문일 수 있다. 더 중요한 것은, “수술이 정말 모든 사람(80대 포함)에게 정답인가?”이다.\n우리가 알고 있는 임상적 사실들을 기반으로 데이터를 만들어보자. 이번 시뮬레이션의 핵심은 치료 효과의 이질성(Interaction)이다. 대략 나이대에 따라 아래와 같이 데이터를 만들어보겠다. 50대: 수술 시 사망률 감소. * 70대: 수술과 시술의 효과가 비슷함. * 고령: 수술 시 오히려 사망률 증가 (수술 위험).\n\nlibrary(tidyverse)\nlibrary(MatchIt)\nlibrary(WeightIt)\nlibrary(cobalt)\nlibrary(sandwich)\nlibrary(lmtest)\nlibrary(data.table)\n\nset.seed(1234)\nn &lt;- 50000\n\n# 1. 교란변수: 나이 (Age)\nage &lt;- rnorm(n, mean = 65, sd = 15)\n\n# 2. 치료 배정\n# 젊을수록 수술 확률 높지만, 너무 극단적이지 않게 설정\nps_true &lt;- plogis(3 - 0.05 * age) \ntreat &lt;- rbinom(n, 1, ps_true)\n\n# 3. 결과 생성 (Outcome)\ntrt_logOR &lt;- ifelse(age &lt;= 66, -0.2 * (66 - age), 0.001 * (age - 66)^2)\nmortality_prob &lt;- plogis(-2.4 + 0.07 * (age - 65) + treat * trt_logOR)\nmortality &lt;- rbinom(n, 1, mortality_prob)\n\ndf &lt;-tibble(age, treat, mortality)\ndt&lt;- as.data.table(df) \n\n# 수술군과 비수술군의 평균 나이 비교 \ndt[, .(mean_age = mean(age)), by = treat]\n\n   treat mean_age\n   &lt;int&gt;    &lt;num&gt;\n1:     0 69.48718\n2:     1 59.42072\n\n# 간단한 리스크(사망률) 요약 함수 (가중치 있으면 가중 평균)\nestimate_risk &lt;- function(data, w = NULL) {\n  if (is.null(w)) w &lt;- rep(1, nrow(data))\n  p1 &lt;- weighted.mean(data$mortality[data$treat == 1], w[data$treat == 1])\n  p0 &lt;- weighted.mean(data$mortality[data$treat == 0], w[data$treat == 0])\n  tibble(p_treat = p1, p_control = p0, RD = p1 - p0, RR = p1 / p0)\n}\n\n이 데이터 구조에서 ATT (수술받은 사람들의 효과)는 결국 수술받은 사람들(평균 60살 정도의 젊은 연령층)에게서의 수술 vs 시술의 치료효과라고 할 수 있을 것이다. ATE (전체 인구의 효과: 데이터에서 설정한 65세 즉 60세 수술군과 대략 69세 수술군의 평균 인구)에서의 수술 vs 시술의 치료효과라고 할 수 있을 것이다."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#method-1-propensity-score-matching",
    "href": "posts/2026-01-02-propensity-score/index.html#method-1-propensity-score-matching",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "2. Method 1: Propensity Score Matching",
    "text": "2. Method 1: Propensity Score Matching\n우리는 실제로 수술을 선택할 환자들(상대적으로 젊은 연령층)에게 관심이 있다고 생각해보자. 따라서 Propensity Score matching을 통해 시술군(평균 연령 69세)에서 연령이 비교적 젊은, 즉 수술군과 유사한 사람들만을 선별해내는 과정을 진행할것이다\n\n# 1:1 Matching \nm_out &lt;- matchit(treat ~ age, data = dt, method = \"nearest\", ratio = 1, caliper = 0.1)\nmatched_data &lt;- as.data.table(match.data(m_out))\nmatched_data[,.(mean_age= mean(age)), by = treat]\n\n   treat mean_age\n   &lt;int&gt;    &lt;num&gt;\n1:     0 63.40875\n2:     1 62.65488\n\n\nMatching을 진행한 결과 시술군들의 집단도 상대적으로 젊은 연령(평균 62세)의 사람들만 모집된 것을 알 수 있다.\n결과 추정 (ATT)\n\nlibrary(jstable)\n# (1) 매칭된 표본에서의 사망률 차이 (리스크 스케일; ATT에 가까운 해석)\nestimate_risk(matched_data, w = matched_data$weights)\n\n# A tibble: 1 × 4\n  p_treat p_control      RD    RR\n    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;\n1  0.0848    0.0964 -0.0117 0.879\n\n# (2) 참고: OR로 요약 (모형 가정에 민감)\nfit_psm &lt;- glm(mortality ~ treat + age, data = matched_data, weights = matched_data$weights, family = binomial())\n# OR 계산\ntt&lt;- glmshow.display(fit_psm, decimal = 2)\nprint(tt)\n\n$first.line\n[1] \"Logistic regression predicting mortality\\n\"\n\n$table\n      crude OR.(95%CI)   crude P value adj. OR.(95%CI)    adj. P value\ntreat \"0.87 (0.81,0.93)\" \"&lt; 0.001\"     \"0.88 (0.81,0.95)\" \"&lt; 0.001\"   \nage   \"1.09 (1.09,1.1)\"  \"&lt; 0.001\"     \"1.09 (1.09,1.1)\"  \"&lt; 0.001\"   \n\n$last.lines\n[1] \"No. of observations = 36880\\nAIC value = 19133.8138\\n\\n\"\n\nattr(,\"class\")\n[1] \"display\" \"list\"   \n\n\n매칭은 “수술을 받은 사람들(상대적으로 젊은 집단)”을 타겟으로 하였기 때문에 우리가 지금 확인하고 있는 오즈비는 ATT 의관점에 가깝다는 것을 알 수 있다. 즉 상대적으로 젊은 집단에서는 수술을 하는 것이 시술을 하는 것에 비해 사망의 위험을 줄여준다고 가정할 수 있다. 하지만 이것이 과연 심장판막 질환을 가진 모든 환자에게 수술을 권하는 데이터로 활용될 수 있을까? 여기서 지금 매칭을 하였기 때문에 실제 평균 연령보다 상대적으로 젊고 건강한 군에서 시행한 데이터라는 것을 알 수 있다."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#결론-상반된-결과의-해석",
    "href": "posts/2026-01-02-propensity-score/index.html#결론-상반된-결과의-해석",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "6. 결론: 상반된 결과의 해석",
    "text": "6. 결론: 상반된 결과의 해석\nATT와 ATE는 “어떤 질문에 답하는가”가 다르다. 같은 데이터로도 타겟(estimand)을 바꾸면 요약 효과가 달라질 수 있으므로, 분석 전에 질문을 먼저 고정해야 한다.\n\n\nATT: “실제로 수술을 받은 사람들”을 기준으로, 그들이 시술을 받았더라면? (즉, treated 집단에서의 평균 효과)\n\nATE: “타겟 인구 전체”에서, 모두 수술 vs 모두 시술로 무작위 배정한다면 평균적으로 어떻게 달라질까? (RCT가 추정하는 평균 효과에 가까운 질문)\n\n그리고 치료 효과가 개인/집단 특성(예: age)에 따라 달라진다면, 평균 효과(ATE/ATT)만 보지 말고 ITE/CATE(예: age strata별 효과)도 같이 확인하는 게 해석에 도움이 된다.\n조금 더 확장해보면:\n\n\nITE (Individual Treatment Effect): 한 개인 \\(i\\)에 대해 \\(Y_i(1)-Y_i(0)\\)처럼 정의되는 “개인 수준 효과”다. 하지만 반사실적 결과는 동시에 관측할 수 없어서, ITE 자체는 직접 관측되지 않고(근본 문제), 가정/모형 하에서 예측의 형태로 다룬다.\n\nCATE (Conditional ATE): 특정 조건(예: 60대, 여성, 특정 risk score 구간)에서의 평균 효과 \\(E[Y(1)-Y(0)\\mid X=x]\\)로, “어떤 집단에서 더 이득/해가 큰가?”를 답한다. 위에서 그린 age strata별 OR은 CATE를 아주 단순하게(나이만으로 층화) 들여다보는 한 방법이다.\n실전에서는 CATE를 보기 위해 (1) 사전에 정의한 subgroup 분석, (2) treat × covariate 상호작용 모형, (3) 보다 유연한 ML 기반 방법(예: causal forest/DR-learner 등) 같은 접근을 쓴다. 중요한 건 “전체 평균(ATE/ATT)”을 한 줄로 결론내리기 전에, 효과 이질성(heterogeneity)이 결론을 바꿀 만큼 큰지 함께 점검하는 것이다.\n\n다음 편에서는 이 복잡한 이야기에 시간(Time)을 더해보자. Immortal Time Bias와 Target Trial Emulation으로 가는 여정이다."
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#method-3-overlap-weighting-ow-target-ato",
    "href": "posts/2026-01-02-propensity-score/index.html#method-3-overlap-weighting-ow-target-ato",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "4. Method 3: Overlap Weighting (OW, Target: ATO)",
    "text": "4. Method 3: Overlap Weighting (OW, Target: ATO)\n현실에서는 ATE가 지나치게 외삽(extrapolation)처럼 느껴질 때가 있다(예: 실제로는 거의 수술하지 않는 초고령). 이때 Overlap Weighting(OW)는 두 군의 공통 영역(overlap)에 더 집중해, 극단적인 가중치를 줄이고 보다 “현실적인” 타겟 집단(ATO)을 만든다.\n\nw_ow &lt;- weightit(treat ~ age, data = dt, method = \"glm\", estimand = \"ATO\")\nsummary(w_ow$weights)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n0.04119 0.31395 0.42959 0.43810 0.55493 0.94710 \n\n# ATO(=overlap population)에서의 사망률 차이\nestimate_risk(dt, w = w_ow$weights)\n\n# A tibble: 1 × 4\n  p_treat p_control       RD    RR\n    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;\n1  0.0996     0.106 -0.00598 0.943\n\n\n마지막으로 세 가지 타겟(ATT/ATE/ATO)을 한 표로 요약해보자.\n\nbind_rows(\n  estimate_risk(matched_data, w = matched_data$weights) %&gt;% mutate(estimand = \"ATT (PSM)\"),\n  estimate_risk(dt, w = w_ate$weights) %&gt;% mutate(estimand = \"ATE (IPTW)\"),\n  estimate_risk(dt, w = w_ow$weights) %&gt;% mutate(estimand = \"ATO (OW)\")\n) %&gt;% select(estimand, everything())\n\n# A tibble: 3 × 5\n  estimand   p_treat p_control       RD    RR\n  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;\n1 ATT (PSM)   0.0848    0.0964 -0.0117  0.879\n2 ATE (IPTW)  0.119     0.118   0.00114 1.01 \n3 ATO (OW)    0.0996    0.106  -0.00598 0.943"
  },
  {
    "objectID": "posts/2026-01-02-propensity-score/index.html#sensitivity-analysis-결과가-얼마나-흔들리나",
    "href": "posts/2026-01-02-propensity-score/index.html#sensitivity-analysis-결과가-얼마나-흔들리나",
    "title": "Causal Inference (2): Propensity Score Matching",
    "section": "5. Sensitivity Analysis: 결과가 얼마나 흔들리나?",
    "text": "5. Sensitivity Analysis: 결과가 얼마나 흔들리나?\n5.1 IPTW: weight trimming에 대한 민감도\n\nw_ate_99 &lt;- trim(w_ate, at = .99)\n\nTrimming weights to 99%.\n\nw_ate_95 &lt;- trim(w_ate, at = .95)\n\nTrimming weights to 95%.\n\nbind_rows(\n  estimate_risk(dt, w = w_ate$weights)     %&gt;% mutate(spec = \"ATE (untrimmed)\"),\n  estimate_risk(dt, w = w_ate_99$weights)  %&gt;% mutate(spec = \"ATE (trim 99%)\"),\n  estimate_risk(dt, w = w_ate_95$weights)  %&gt;% mutate(spec = \"ATE (trim 95%)\")\n) %&gt;% select(spec, everything())\n\n# A tibble: 3 × 5\n  spec            p_treat p_control       RD    RR\n  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;\n1 ATE (untrimmed)   0.119     0.118  0.00114 1.01 \n2 ATE (trim 99%)    0.112     0.118 -0.00635 0.946\n3 ATE (trim 95%)    0.102     0.119 -0.0175  0.853\n\n\n5.2 PSM: caliper 변화에 대한 민감도\n\nrun_psm &lt;- function(cal) {\n  m &lt;- matchit(treat ~ age, data = dt, method = \"nearest\", ratio = 1, caliper = cal)\n  d &lt;- as.data.table(match.data(m))\n  estimate_risk(d, w = d$weights) %&gt;% mutate(caliper = cal)\n}\n\nbind_rows(run_psm(0.05), run_psm(0.1), run_psm(0.2)) %&gt;%\n  select(caliper, everything())\n\n# A tibble: 3 × 5\n  caliper p_treat p_control      RD    RR\n    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;\n1    0.05  0.0865    0.0969 -0.0104 0.893\n2    0.1   0.0848    0.0964 -0.0117 0.879\n3    0.2   0.0812    0.0977 -0.0166 0.831"
  }
]